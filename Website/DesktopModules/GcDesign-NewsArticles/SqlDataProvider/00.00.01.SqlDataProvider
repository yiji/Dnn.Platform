IF EXISTS ( SELECT  *
            FROM    sys.default_constraints
            WHERE   object_id = OBJECT_ID(N'[dbo].[DF__GcDesign___IsSec__689361F1]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Article]') )
    BEGIN
        IF EXISTS ( SELECT  *
                    FROM    dbo.sysobjects
                    WHERE   id = OBJECT_ID(N'[DF__GcDesign___IsSec__689361F1]')
                            AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Article] DROP CONSTRAINT [DF__GcDesign___IsSec__689361F1]
            END


    END
GO
IF EXISTS ( SELECT  *
            FROM    sys.default_constraints
            WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Article_IsNewWindow]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Article]') )
    BEGIN
        IF EXISTS ( SELECT  *
                    FROM    dbo.sysobjects
                    WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Article_IsNewWindow]')
                            AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Article] DROP CONSTRAINT [DF_GcDesign_Searches_Article_IsNewWindow]
            END


    END
GO
IF EXISTS ( SELECT  *
            FROM    sys.default_constraints
            WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Category_InheritSecurity]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Category]') )
    BEGIN
        IF EXISTS ( SELECT  *
                    FROM    dbo.sysobjects
                    WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Category_InheritSecurity]')
                            AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Category] DROP CONSTRAINT [DF_GcDesign_Searches_Category_InheritSecurity]
            END


    END
GO
IF EXISTS ( SELECT  *
            FROM    sys.default_constraints
            WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Category_CategorySecurityType]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Category]') )
    BEGIN
        IF EXISTS ( SELECT  *
                    FROM    dbo.sysobjects
                    WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Category_CategorySecurityType]')
                            AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Category] DROP CONSTRAINT [DF_GcDesign_Searches_Category_CategorySecurityType]
            END


    END
GO
IF EXISTS ( SELECT  *
            FROM    sys.default_constraints
            WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Comment_CreatedDate]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]') )
    BEGIN
        IF EXISTS ( SELECT  *
                    FROM    dbo.sysobjects
                    WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Comment_CreatedDate]')
                            AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Comment] DROP CONSTRAINT [DF_GcDesign_Searches_Comment_CreatedDate]
            END


    END
GO
IF EXISTS ( SELECT  *
            FROM    sys.default_constraints
            WHERE   object_id = OBJECT_ID(N'[dbo].[DF__GcDesign_S__Type__548C6944]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]') )
    BEGIN
        IF EXISTS ( SELECT  *
                    FROM    dbo.sysobjects
                    WHERE   id = OBJECT_ID(N'[DF__GcDesign_S__Type__548C6944]')
                            AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Comment] DROP CONSTRAINT [DF__GcDesign_S__Type__548C6944]
            END


    END
GO
IF EXISTS ( SELECT  *
            FROM    sys.default_constraints
            WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Comment_NotifyMe]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]') )
    BEGIN
        IF EXISTS ( SELECT  *
                    FROM    dbo.sysobjects
                    WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Comment_NotifyMe]')
                            AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Comment] DROP CONSTRAINT [DF_GcDesign_Searches_Comment_NotifyMe]
            END


    END
GO
IF EXISTS ( SELECT  *
            FROM    sys.default_constraints
            WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Comment_isApproved]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]') )
    BEGIN
        IF EXISTS ( SELECT  *
                    FROM    dbo.sysobjects
                    WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Comment_isApproved]')
                            AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Comment] DROP CONSTRAINT [DF_GcDesign_Searches_Comment_isApproved]
            END


    END
GO
IF EXISTS ( SELECT  *
            FROM    sys.default_constraints
            WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Feed_DateMode]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Feed]') )
    BEGIN
        IF EXISTS ( SELECT  *
                    FROM    dbo.sysobjects
                    WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Feed_DateMode]')
                            AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Feed] DROP CONSTRAINT [DF_GcDesign_Searches_Feed_DateMode]
            END


    END
GO
IF EXISTS ( SELECT  *
            FROM    sys.default_constraints
            WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Image_SortOrder]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Image]') )
    BEGIN
        IF EXISTS ( SELECT  *
                    FROM    dbo.sysobjects
                    WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Image_SortOrder]')
                            AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Image] DROP CONSTRAINT [DF_GcDesign_Searches_Image_SortOrder]
            END


    END
GO
IF EXISTS ( SELECT  *
            FROM    sys.default_constraints
            WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Page_SortOrder]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Page]') )
    BEGIN
        IF EXISTS ( SELECT  *
                    FROM    dbo.sysobjects
                    WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Page_SortOrder]')
                            AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Page] DROP CONSTRAINT [DF_GcDesign_Searches_Page_SortOrder]
            END


    END
GO
/****** Object:  ForeignKey [FK_GcDesign_Searches_Article_Modules]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.foreign_keys
            WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_Article_Modules]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Article]') )
    ALTER TABLE [dbo].[GcDesign_Searches_Article] DROP CONSTRAINT [FK_GcDesign_Searches_Article_Modules]
GO
/****** Object:  ForeignKey [FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Article]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.foreign_keys
            WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Article]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleCategories]') )
    ALTER TABLE [dbo].[GcDesign_Searches_ArticleCategories] DROP CONSTRAINT [FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Article]
GO
/****** Object:  ForeignKey [FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Category]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.foreign_keys
            WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Category]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleCategories]') )
    ALTER TABLE [dbo].[GcDesign_Searches_ArticleCategories] DROP CONSTRAINT [FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Category]
GO
/****** Object:  ForeignKey [FK_GcDesign_Searches_Category_Modules]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.foreign_keys
            WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_Category_Modules]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Category]') )
    ALTER TABLE [dbo].[GcDesign_Searches_Category] DROP CONSTRAINT [FK_GcDesign_Searches_Category_Modules]
GO
/****** Object:  ForeignKey [FK_GcDesign_Searches_Comment_GcDesign_Searches_Article]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.foreign_keys
            WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_Comment_GcDesign_Searches_Article]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]') )
    ALTER TABLE [dbo].[GcDesign_Searches_Comment] DROP CONSTRAINT [FK_GcDesign_Searches_Comment_GcDesign_Searches_Article]
GO
/****** Object:  ForeignKey [FK_GcDesign_Searches_Page_GcDesign_Searches_Article]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.foreign_keys
            WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_Page_GcDesign_Searches_Article]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Page]') )
    ALTER TABLE [dbo].[GcDesign_Searches_Page] DROP CONSTRAINT [FK_GcDesign_Searches_Page_GcDesign_Searches_Article]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddPage]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddPage]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_AddPage]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddComment]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddComment]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_AddComment]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteArticle]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteArticle]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_DeleteArticle]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteArticleCategories]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteArticleCategories]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_DeleteArticleCategories]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteCategory]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteCategory]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_DeleteCategory]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteComment]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteComment]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_DeleteComment]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeletePage]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeletePage]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_DeletePage]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddArticle]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddArticle]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_AddArticle]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddArticleCategory]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddArticleCategory]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_AddArticleCategory]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCategoryListAll]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCategoryListAll]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetCategoryListAll]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetComment]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetComment]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetComment]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCommentList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCommentList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetCommentList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetPage]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetPage]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetPage]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetPageList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetPageList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetPageList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetArticle]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetArticle]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetArticle]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetArticleCategories]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetArticleCategories]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetArticleCategories]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetArticleListBySearchCriteria]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetArticleListBySearchCriteria]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetArticleListBySearchCriteria]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetArticleListBySearchCriteria1]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetArticleListBySearchCriteria1]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetArticleListBySearchCriteria1]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateComment]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateComment]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_UpdateComment]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateArticle]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateArticle]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_UpdateArticle]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdatePage]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdatePage]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_UpdatePage]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateArticleCount]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateArticleCount]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_UpdateArticleCount]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateCategory]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateCategory]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_UpdateCategory]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_RatingAdd]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_RatingAdd]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_RatingAdd]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_RatingDelete]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_RatingDelete]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_RatingDelete]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetAuthorList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetAuthorList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetAuthorList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCategory]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCategory]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetCategory]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCategoryList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCategoryList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetCategoryList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetMirrorArticleList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetMirrorArticleList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetMirrorArticleList]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Page]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Page]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_Page]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddCategory]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddCategory]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_AddCategory]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedCategoryList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedCategoryList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FeedCategoryList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_Category_MoveNodeBefore]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Category_MoveNodeBefore]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_Category_MoveNodeBefore]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Comment]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_Comment]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_ArticleCategories]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleCategories]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_ArticleCategories]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Article]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Article]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_Article]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Category]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Category]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_Category]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_TagDelete]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_TagDelete]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_TagDelete]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddCustomField]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddCustomField]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_AddCustomField]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddCustomValue]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddCustomValue]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_AddCustomValue]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddHandout]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddHandout]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_AddHandout]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddHandoutArticle]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddHandoutArticle]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_AddHandoutArticle]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddMirrorArticle]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddMirrorArticle]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_AddMirrorArticle]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteCustomField]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteCustomField]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_DeleteCustomField]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteCustomValue]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteCustomValue]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_DeleteCustomValue]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteHandout]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteHandout]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_DeleteHandout]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteHandoutArticleList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteHandoutArticleList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_DeleteHandoutArticleList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedDelete]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedDelete]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FeedDelete]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedGet]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedGet]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FeedGet]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FeedList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedUpdate]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedUpdate]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FeedUpdate]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ArticleTagAdd]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleTagAdd]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_ArticleTagAdd]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ArticleTagDelete]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleTagDelete]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_ArticleTagDelete]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ArticleTagDeleteByTag]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleTagDeleteByTag]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_ArticleTagDeleteByTag]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedAdd]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedAdd]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FeedAdd]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_EmailTemplateAdd]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplateAdd]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_EmailTemplateAdd]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_EmailTemplateDelete]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplateDelete]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_EmailTemplateDelete]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_EmailTemplateGet]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplateGet]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_EmailTemplateGet]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_EmailTemplateGetByName]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplateGetByName]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_EmailTemplateGetByName]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_EmailTemplateList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplateList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_EmailTemplateList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_EmailTemplateUpdate]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplateUpdate]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_EmailTemplateUpdate]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedCategoryAdd]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedCategoryAdd]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FeedCategoryAdd]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedCategoryDelete]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedCategoryDelete]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FeedCategoryDelete]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FileAdd]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FileAdd]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FileAdd]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FileDelete]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FileDelete]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FileDelete]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FileGet]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FileGet]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FileGet]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FileList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FileList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FileList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FileUpdate]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FileUpdate]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_FileUpdate]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCustomField]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCustomField]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetCustomField]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCustomFieldList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCustomFieldList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetCustomFieldList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCustomValueByField]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCustomValueByField]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetCustomValueByField]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCustomValueList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCustomValueList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetCustomValueList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetHandout]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetHandout]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetHandout]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetHandoutArticleList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetHandoutArticleList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetHandoutArticleList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetHandoutList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetHandoutList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetHandoutList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetMirrorArticle]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetMirrorArticle]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetMirrorArticle]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_TagAdd]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_TagAdd]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_TagAdd]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_TagGet]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_TagGet]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_TagGet]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_TagGetByName]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_TagGetByName]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_TagGetByName]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_TagList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_TagList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_TagList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_TagUpdate]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_TagUpdate]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_TagUpdate]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateCustomField]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateCustomField]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_UpdateCustomField]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateCustomValue]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateCustomValue]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_UpdateCustomValue]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateHandout]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateHandout]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_UpdateHandout]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_RatingGet]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_RatingGet]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_RatingGet]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_RatingGetByID]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_RatingGetByID]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_RatingGetByID]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ImageAdd]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ImageAdd]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_ImageAdd]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ImageDelete]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ImageDelete]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_ImageDelete]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ImageGet]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ImageGet]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_ImageGet]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ImageList]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ImageList]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_ImageList]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ImageUpdate]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ImageUpdate]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_ImageUpdate]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Mirror]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Mirror]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_Mirror]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetNewsArchive]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetNewsArchive]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetNewsArchive]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetAuthorStatistics]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetAuthorStatistics]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_GetAuthorStatistics]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Rating]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Rating]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_Rating]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_SecureCheck]    Script Date: 04/19/2015 21:16:00 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_SecureCheck]')
                    AND type IN ( N'P', N'PC' ) )
    DROP PROCEDURE [dbo].[GcDesign_Searches_SecureCheck]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Tag]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Tag]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_Tag]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Handout]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Handout]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_Handout]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_HandoutArticle]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_HandoutArticle]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_HandoutArticle]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Image]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Image]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_Image]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Feed]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Feed]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_Feed]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_EmailTemplate]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplate]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_EmailTemplate]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_FeedCategory]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedCategory]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_FeedCategory]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_File]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_File]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_File]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_CustomField]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_CustomField]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_CustomField]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_CustomValue]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_CustomValue]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_CustomValue]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_ArticleTag]    Script Date: 04/19/2015 21:16:02 ******/
IF EXISTS ( SELECT  *
            FROM    sys.objects
            WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleTag]')
                    AND type IN ( N'U' ) )
    DROP TABLE [dbo].[GcDesign_Searches_ArticleTag]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_ArticleTag]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleTag]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_ArticleTag]
            (
              [ArticleID] [INT] NOT NULL ,
              [TagID] [INT] NOT NULL ,
              CONSTRAINT [PK_GcDesign_Searches_ArticleTag] PRIMARY KEY CLUSTERED
                ( [ArticleID] ASC, [TagID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY]
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_CustomValue]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_CustomValue]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_CustomValue]
            (
              [CustomValueID] [INT] IDENTITY(1, 1)
                                    NOT NULL ,
              [ArticleID] [INT] NOT NULL ,
              [CustomFieldID] [INT] NOT NULL ,
              [CustomValue] [NTEXT] COLLATE Chinese_PRC_CI_AS
                                    NOT NULL ,
              CONSTRAINT [PK_GcDesign_Searches_CustomValue] PRIMARY KEY CLUSTERED
                ( [CustomValueID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY] TEXTIMAGE_ON [PRIMARY]
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_CustomField]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_CustomField]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_CustomField]
            (
              [CustomFieldID] [INT] IDENTITY(1, 1)
                                    NOT NULL ,
              [ModuleID] [INT] NOT NULL ,
              [Name] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                     NOT NULL ,
              [FieldType] [INT] NOT NULL ,
              [FieldElements] [NTEXT] COLLATE Chinese_PRC_CI_AS
                                      NULL ,
              [DefaultValue] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                             NULL ,
              [Caption] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                        NULL ,
              [CaptionHelp] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                            NULL ,
              [IsRequired] [BIT] NOT NULL ,
              [IsVisible] [BIT] NOT NULL ,
              [SortOrder] [INT] NOT NULL ,
              [ValidationType] [INT] NOT NULL ,
              [RegularExpression] [NVARCHAR](4000) COLLATE Chinese_PRC_CI_AS
                                                   NULL ,
              [Length] [INT] NULL ,
              CONSTRAINT [PK_GcDesign_Searches_CustomField] PRIMARY KEY CLUSTERED
                ( [CustomFieldID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY] TEXTIMAGE_ON [PRIMARY]
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_File]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_File]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_File]
            (
              [FileID] [INT] IDENTITY(1, 1)
                             NOT NULL ,
              [ArticleID] [INT] NULL ,
              [Title] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                      NULL ,
              [FileName] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                         NULL ,
              [Extension] [NVARCHAR](100) COLLATE Chinese_PRC_CI_AS
                                          NULL ,
              [Size] [INT] NULL ,
              [ContentType] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                            NULL ,
              [Folder] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                       NULL ,
              [SortOrder] [INT] NOT NULL ,
              [FileGuid] [NVARCHAR](50) COLLATE Chinese_PRC_CI_AS
                                        NULL ,
              CONSTRAINT [PK_GcDesign_Searches_File] PRIMARY KEY CLUSTERED
                ( [fileid] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY]
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_FeedCategory]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedCategory]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_FeedCategory]
            (
              [FeedID] [INT] NOT NULL ,
              [CategoryID] [INT] NOT NULL ,
              CONSTRAINT [PK_GcDesign_Searches_FeedCategory] PRIMARY KEY CLUSTERED
                ( [FeedID] ASC, [CategoryID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY]
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_EmailTemplate]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplate]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_EmailTemplate]
            (
              [TemplateID] [INT] IDENTITY(1, 1)
                                 NOT NULL ,
              [ModuleID] [INT] NOT NULL ,
              [Name] [NVARCHAR](50) COLLATE Chinese_PRC_CI_AS
                                    NOT NULL ,
              [Subject] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                        NOT NULL ,
              [Template] [NTEXT] COLLATE Chinese_PRC_CI_AS
                                 NOT NULL ,
              CONSTRAINT [PK_GcDesign_Searches_EmailTemplate] PRIMARY KEY CLUSTERED
                ( [TemplateID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY] TEXTIMAGE_ON [PRIMARY]
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Feed]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Feed]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_Feed]
            (
              [FeedID] [INT] IDENTITY(1, 1)
                             NOT NULL ,
              [ModuleID] [INT] NOT NULL ,
              [Title] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                      NULL ,
              [Url] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                    NOT NULL ,
              [UserID] [INT] NOT NULL ,
              [AutoFeature] [BIT] NOT NULL ,
              [IsActive] [BIT] NOT NULL ,
              [DateMode] [INT] NOT NULL ,
              [AutoExpire] [INT] NULL ,
              [AutoExpireUnit] [INT] NULL ,
              CONSTRAINT [PK_GcDesign_Searches_Feed] PRIMARY KEY CLUSTERED
                ( [FeedID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY]
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Image]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Image]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_Image]
            (
              [ImageID] [INT] IDENTITY(1, 1)
                              NOT NULL ,
              [ArticleID] [INT] NULL ,
              [FileName] [NVARCHAR](100) COLLATE Chinese_PRC_CI_AS
                                         NULL ,
              [Extension] [NVARCHAR](100) COLLATE Chinese_PRC_CI_AS
                                          NULL ,
              [Size] [INT] NULL ,
              [Width] [INT] NULL ,
              [Height] [INT] NULL ,
              [ContentType] [NVARCHAR](200) COLLATE Chinese_PRC_CI_AS
                                            NULL ,
              [Folder] [NVARCHAR](200) COLLATE Chinese_PRC_CI_AS
                                       NULL ,
              [SortOrder] [INT] NOT NULL ,
              [ImageGuid] [NVARCHAR](50) COLLATE Chinese_PRC_CI_AS
                                         NULL ,
              [Title] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                      NULL ,
              [Description] [NTEXT] COLLATE Chinese_PRC_CI_AS
                                    NULL ,
              CONSTRAINT [PK_GcDesign_Searches_Image] PRIMARY KEY CLUSTERED
                ( [ImageID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY] TEXTIMAGE_ON [PRIMARY]
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_HandoutArticle]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_HandoutArticle]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_HandoutArticle]
            (
              [HandoutID] [INT] NOT NULL ,
              [ArticleID] [INT] NOT NULL ,
              [SortOrder] [INT] NOT NULL ,
              CONSTRAINT [PK_GcDesign_Searches_HandoutArticle] PRIMARY KEY CLUSTERED
                ( [HandoutID] ASC, [ArticleID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY]
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Handout]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Handout]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_Handout]
            (
              [HandoutID] [INT] IDENTITY(1, 1)
                                NOT NULL ,
              [ModuleID] [INT] NOT NULL ,
              [UserID] [INT] NULL ,
              [Name] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                     NOT NULL ,
              [Description] [NTEXT] COLLATE Chinese_PRC_CI_AS
                                    NULL ,
              CONSTRAINT [PK_GcDesign_Searches_Handout] PRIMARY KEY CLUSTERED
                ( [HandoutID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY] TEXTIMAGE_ON [PRIMARY]
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Tag]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Tag]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_Tag]
            (
              [TagID] [INT] IDENTITY(1, 1)
                            NOT NULL ,
              [ModuleID] [INT] NOT NULL ,
              [Name] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                     NOT NULL ,
              [NameLowered] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                            NOT NULL ,
              [Usages] [INT] NULL ,
              CONSTRAINT [PK_GcDesign_Searches_Tag] PRIMARY KEY CLUSTERED
                ( [TagID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY]
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_SecureCheck]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_SecureCheck]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_SecureCheck]
	@PortalID [int],
	@ArticleID [int],
	@UserID [int]
WITH EXECUTE AS CALLER
AS
SELECT 1' 
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Rating]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Rating]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_Rating]
            (
              [RatingID] [INT] IDENTITY(1, 1)
                               NOT NULL ,
              [ArticleID] [INT] NOT NULL ,
              [UserID] [INT] NOT NULL ,
              [CreatedDate] [DATETIME] NOT NULL ,
              [Rating] [FLOAT] NULL ,
              CONSTRAINT [PK_GcDesign_Searches_Rating] PRIMARY KEY CLUSTERED
                ( [RatingID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY]
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetAuthorStatistics]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetAuthorStatistics]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetAuthorStatistics]
	@ModuleID [int],
	@CategoryID [varchar](2000),
	@CategoryIDExclude [varchar](2000),
	@AuthorID [int],
	@SortBy [varchar](255),
	@ShowPending [bit]
WITH EXECUTE AS CALLER
AS
DECLARE @strTop	nvarchar(2000)
DECLARE @strWhere	nvarchar(2000)

SELECT @strTop = ''''
SELECT @strWhere = ''''

IF (@ModuleID is not null)
	SELECT @strWhere = @strWhere + '' AND Articles.ModuleID = '' + convert(nvarchar, @ModuleId)
	
IF (@CategoryId is not null)
BEGIN
	IF( CHARINDEX(''-1'', @CategoryID) = 0 )
	BEGIN
		SELECT @strWhere = @strWhere + '' AND Articles.ArticleID in (select ArticleID from dbo.GcDesign_Searches_ArticleCategories ArticleCategories where ArticleCategories.CategoryID in ('' + @CategoryID + ''))''
	END
	ELSE
	BEGIN
		SELECT @strWhere = @strWhere + '' AND (Articles.ArticleID in (select ArticleID from dbo.GcDesign_Searches_ArticleCategories ArticleCategories where ArticleCategories.CategoryID in ('' + @CategoryID + '')) OR Articles.ArticleID not in (select ArticleID from dbo.GcDesign_Searches_ArticleCategories))''
	END
END

IF (@CategoryIDExclude is not null)
BEGIN
	SELECT @strWhere = @strWhere + '' AND Articles.ArticleID NOT IN (select ArticleID from dbo.GcDesign_Searches_ArticleCategories ArticleCategories where ArticleCategories.CategoryID in ('' + @CategoryIDExclude + ''))''
END

IF (@AuthorID is not null)
	SELECT @strWhere = @strWhere + '' AND Articles.AuthorID = '' + convert(nvarchar, @AuthorID)

IF (@ShowPending is null )
	SELECT @strWhere = @strWhere + '' AND (Articles.StartDate is null OR Articles.StartDate < '''''' + CONVERT(char(24), DateAdd(mi, 1, GetDate()), 126)  + '''''')''

EXEC(''
SELECT     
	UserID, UserName, DisplayName, FirstName, LastName, count(*) as ''''ArticleCount''''   
FROM         
	dbo.Users Users, dbo.GcDesign_Searches_Article Articles
where Articles.IsApproved = 1 and Articles.IsDraft = 0 and Users.UserID = Articles.AuthorID '' + 
	@strWhere + '' 
GROUP BY 
	UserID, UserName, DisplayName, FirstName, LastName
ORDER BY '' +
	@SortBy)' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetNewsArchive]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetNewsArchive]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetNewsArchive]
	@ModuleID [int],
	@CategoryID [varchar](2000),
	@CategoryIDExclude [varchar](2000),
	@AuthorID [int],
	@GroupBy [varchar](255),
	@ShowPending [bit]
WITH EXECUTE AS CALLER
AS
DECLARE @strTop	nvarchar(2000)
DECLARE @strWhere	nvarchar(2000)

SELECT @strTop = ''''
SELECT @strWhere = ''''

IF (@ModuleID is not null)
	SELECT @strWhere = @strWhere + '' AND Article.ModuleID = '' + convert(nvarchar, @ModuleId)
	
IF (@CategoryId is not null)
BEGIN
	IF( CHARINDEX(''-1'', @CategoryID) = 0 )
	BEGIN
		SELECT @strWhere = @strWhere + '' AND Article.ArticleID in ( select ArticleID from dbo.GcDesign_Searches_ArticleCategories where dbo.GcDesign_Searches_ArticleCategories.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleCategories.CategoryID in ('' + @CategoryID + ''))''
	END
	ELSE
	BEGIN
		SELECT @strWhere = @strWhere + '' AND (Article.ArticleID in ( select ArticleID from dbo.GcDesign_Searches_ArticleCategories where dbo.GcDesign_Searches_ArticleCategories.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleCategories.CategoryID in ('' + @CategoryID + '')) OR Article.ArticleID not in (select ArticleID from dbo.GcDesign_Searches_ArticleCategories))''
	END
END

IF (@CategoryIDExclude is not null)
BEGIN
	SELECT @strWhere = @strWhere + '' AND Article.ArticleID NOT IN (select ArticleID from dbo.GcDesign_Searches_ArticleCategories ArticleCategories where ArticleCategories.CategoryID in ('' + @CategoryIDExclude + ''))''
END

IF (@AuthorID is not null)
	SELECT @strWhere = @strWhere + '' AND Article.AuthorID = '' + convert(nvarchar, @AuthorID)

IF (@ShowPending is null)
BEGIN
	SELECT @strWhere = @strWhere + '' AND (Article.StartDate is null or Article.StartDate < '''''' + CONVERT(char(24), DateAdd(mi, 1, GetDate()), 126)  + '''''')''
END

IF( @GroupBy = ''Month'' )
BEGIN
EXEC(''
    select Month(StartDate) as [Month], Year(StartDate) as [Year], 1 as Day, Count(*) as [Count]
    from dbo.GcDesign_Searches_Article Article
    where IsApproved = 1 and IsDraft = 0 '' + 
	    @strWhere + ''
    group by Year(StartDate), Month(StartDate)
    order by [Year] desc, [Month] desc'')
END
ELSE
BEGIN
EXEC(''
    select 1 as [Month], Year(StartDate) as [Year], 1 as Day, Count(*) as [Count]
    from dbo.GcDesign_Searches_Article Article
    where IsApproved = 1 and IsDraft = 0 '' + 
	    @strWhere + ''
    group by Year(StartDate)
    order by [Year] desc'')
END' 
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Mirror]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Mirror]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_Mirror]
            (
              [ArticleID] [INT] NOT NULL ,
              [LinkedArticleID] [INT] NOT NULL ,
              [LinkedPortalID] [INT] NOT NULL ,
              [AutoUpdate] [BIT] NOT NULL ,
              CONSTRAINT [PK_GcDesign_Searches_Mirror] PRIMARY KEY CLUSTERED
                ( [ArticleID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY]
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ImageUpdate]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ImageUpdate]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_ImageUpdate]
	@ImageID [int],
	@ArticleID [int],
	@Title [nvarchar](255),
	@FileName [nvarchar](100),
	@Extension [nvarchar](100),
	@Size [int],
	@Width [int],
	@Height [int],
	@ContentType [nvarchar](200),
	@Folder [nvarchar](200),
	@SortOrder [int],
	@ImageGuid [nvarchar](50),
	@Description [ntext]
WITH EXECUTE AS CALLER
AS
UPDATE
	dbo.GcDesign_Searches_Image
SET
	[ArticleID] = @ArticleID,
	[Title] = @Title,
	[FileName] = @FileName,
	[Extension] = @Extension,
	[Size] = @Size,
	[Width] = @Width,
	[Height] = @Height,
	[ContentType] = @ContentType,
	[Folder] = @Folder,
	[SortOrder] = @SortOrder,
	[ImageGuid] = @ImageGuid,
	[Description] = @Description
WHERE
	[ImageID] = @ImageID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ImageList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ImageList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_ImageList]
	@ArticleID [int],
	@ImageGuid [nvarchar](50)
WITH EXECUTE AS CALLER
AS
SELECT     
	ImageID, 
	ArticleID, 
	Title, 
	FileName, 
	Extension, 
	Size, 
	Width, 
	Height, 
	ContentType, 
	Folder, 
	SortOrder, 
	ImageGuid,
	Description 
FROM         
	dbo.GcDesign_Searches_Image
WHERE
	(@ArticleID IS NULL OR ArticleID = @ArticleID) 
	AND
	(@ImageGuid IS NULL OR ImageGuid = @ImageGuid) 
ORDER BY 
	SortOrder' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ImageGet]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ImageGet]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_ImageGet]
	@ImageID [int]
WITH EXECUTE AS CALLER
AS
SELECT     
	ImageID, 
	ArticleID, 
	Title, 
	FileName, 
	Extension, 
	Size, 
	Width, 
	Height, 
	ContentType, 
	Folder, 
	SortOrder, 
	ImageGuid,
	Description 
FROM         
	dbo.GcDesign_Searches_Image
WHERE
	ImageID = @ImageID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ImageDelete]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ImageDelete]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_ImageDelete]
	@ImageID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM dbo.GcDesign_Searches_Image WHERE ImageID = @ImageID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ImageAdd]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ImageAdd]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_ImageAdd]
	@ArticleID [int],
	@Title [nvarchar](255),
	@FileName [nvarchar](100),
	@Extension [nvarchar](100),
	@Size [int],
	@Width [int],
	@Height [int],
	@ContentType [nvarchar](200),
	@Folder [nvarchar](200),
	@SortOrder [int],
	@ImageGuid [nvarchar](50),
	@Description [ntext]
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_Image (
	[ArticleID],
	[Title],
	[FileName],
	[Extension],
	[Size],
	[Width],
	[Height],
	[ContentType],
	[Folder],
	[SortOrder],
	[ImageGuid],
	[Description] 
) VALUES (
	@ArticleID,
	@Title,
	@FileName,
	@Extension,
	@Size,
	@Width,
	@Height,
	@ContentType,
	@Folder,
	@SortOrder,
	@ImageGuid,
	@Description 
)

select SCOPE_IDENTITY()' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_RatingGetByID]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_RatingGetByID]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_RatingGetByID]
	@RatingID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	[RatingID],
	[ArticleID],
	[UserID],
	[CreatedDate],
	[Rating]
FROM dbo.GcDesign_Searches_Rating
WHERE
	[RatingID] = @RatingID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_RatingGet]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_RatingGet]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_RatingGet]
	@ArticleID [int],
	@UserID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	[RatingID],
	[ArticleID],
	[UserID],
	[CreatedDate],
	[Rating]
FROM dbo.GcDesign_Searches_Rating
WHERE
	[ArticleID] = @ArticleID
	and
	[UserID] = @UserID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateHandout]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateHandout]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_UpdateHandout]
	@HandoutID [int],
	@ModuleID [int],
	@UserID [int],
	@Name [nvarchar](255),
	@Description [ntext]
WITH EXECUTE AS CALLER
AS
UPDATE
	dbo.GcDesign_Searches_Handout
SET
	[ModuleID] = @ModuleID,
	[UserID] = @UserID,
	[Name] = @Name,
	[Description] = @Description
WHERE
	HandoutID = @HandoutID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateCustomValue]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateCustomValue]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_UpdateCustomValue]
	@CustomValueID [int],
	@ArticleID [int],
	@CustomFieldID [int],
	@CustomValue [ntext]
WITH EXECUTE AS CALLER
AS
UPDATE dbo.GcDesign_Searches_CustomValue SET
	[ArticleID] = @ArticleID,
	[CustomFieldID] = @CustomFieldID,
	[CustomValue] = @CustomValue
WHERE
	[CustomValueID] = @CustomValueID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateCustomField]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateCustomField]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_UpdateCustomField]
	@CustomFieldID [int],
	@ModuleID [int],
	@Name [nvarchar](255),
	@FieldType [int],
	@FieldElements [ntext],
	@DefaultValue [nvarchar](255),
	@Caption [nvarchar](255),
	@CaptionHelp [nvarchar](255),
	@IsRequired [bit],
	@IsVisible [bit],
	@SortOrder [int],
	@ValidationType [int],
	@Length [int],
	@RegularExpression [nvarchar](4000)
WITH EXECUTE AS CALLER
AS
UPDATE
	dbo.GcDesign_Searches_CustomField
SET
	[ModuleID] = @ModuleID,
	[Name] = @Name,
	[FieldType] = @FieldType,
	[FieldElements] = @FieldElements,
	[DefaultValue] = @DefaultValue,
	[Caption] = @Caption,
	[CaptionHelp] = @CaptionHelp,
	[IsRequired] = @IsRequired,
	[IsVisible] = @IsVisible,
	[SortOrder] = @SortOrder,
	[ValidationType] = @ValidationType,
	[Length] = @Length,
	[RegularExpression] = @RegularExpression
WHERE
	CustomFieldID = @CustomFieldID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_TagUpdate]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_TagUpdate]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_TagUpdate]
	@TagID [int],
	@ModuleID [int],
	@Name [nvarchar](50),
	@NameLowered [nvarchar](50),
	@Usages [int]
WITH EXECUTE AS CALLER
AS
UPDATE
	dbo.GcDesign_Searches_Tag 
SET 
	[ModuleID] = @ModuleID,
	[Name] = @Name,
	[NameLowered] = @NameLowered, 
	[Usages] = @Usages 
WHERE
	[TagID] = @TagID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_TagList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_TagList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_TagList]
	@ModuleID [int],
	@MaxCount [int]
WITH EXECUTE AS CALLER
AS
if( @MaxCount is not null )
begin
	SET ROWCOUNT @MaxCount 
end

SELECT
	t.[TagID],
	t.[ModuleID],
	t.[Name],
	t.[NameLowered],
	t.[Usages] 
FROM 
	dbo.GcDesign_Searches_Tag t
WHERE
	t.[ModuleID] = @ModuleID
ORDER BY 
	t.[Usages] DESC' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_TagGetByName]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_TagGetByName]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_TagGetByName]
	@ModuleID [int],
	@NameLowered [nvarchar](50)
WITH EXECUTE AS CALLER
AS
SELECT TOP 1 
	[TagID],
	[ModuleID],
	[Name],
	[NameLowered],
	[Usages] 
FROM dbo.GcDesign_Searches_Tag
WHERE
	[ModuleID] = @ModuleID
	and
	[NameLowered] = @NameLowered' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_TagGet]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_TagGet]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_TagGet]
	@TagID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	[TagID],
	[ModuleID],
	[Name],
	[NameLowered],
	[Usages] 
FROM dbo.GcDesign_Searches_Tag
WHERE
	[TagID] = @TagID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_TagAdd]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_TagAdd]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_TagAdd]
	@ModuleID [int],
	@Name [nvarchar](50),
	@NameLowered [nvarchar](50)
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_Tag (
	[ModuleID],
	[Name],
	[NameLowered]
) VALUES (
	@ModuleID,
	@Name,
	@NameLowered 
)

select SCOPE_IDENTITY()' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetMirrorArticle]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetMirrorArticle]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetMirrorArticle]
	@ArticleID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	m.[ArticleID],
	m.[LinkedArticleID],
	m.[LinkedPortalID],
	m.[AutoUpdate]    
FROM
	dbo.GcDesign_Searches_Mirror m
WHERE
	m.[ArticleID] = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetHandoutList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetHandoutList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetHandoutList]
	@UserID [int]
WITH EXECUTE AS CALLER
AS
SELECT     
	[HandoutID], 
	[ModuleID], 
	[UserID], 
	[Name], 
	[Description]
FROM         
	dbo.GcDesign_Searches_Handout
WHERE
	[UserID] = @UserID
ORDER BY
	[Name]' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetHandoutArticleList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetHandoutArticleList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetHandoutArticleList]
	@HandoutID [int]
WITH EXECUTE AS CALLER
AS
SELECT     
	[HandoutID], 
	[ArticleID],
	[SortOrder]
FROM         
	dbo.GcDesign_Searches_HandoutArticle
WHERE
	HandoutID = @HandoutID
ORDER BY 
	[SortOrder] ASC' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetHandout]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetHandout]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetHandout]
	@HandoutID [int]
WITH EXECUTE AS CALLER
AS
SELECT     
	[HandoutID], 
	[ModuleID], 
	[UserID], 
	[Name], 
	[Description]
FROM         
	dbo.GcDesign_Searches_Handout
WHERE
	HandoutID = @HandoutID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCustomValueList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCustomValueList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetCustomValueList]
	@ArticleID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	[CustomValueID],
	[ArticleID],
	[CustomFieldID],
	[CustomValue]
FROM 
	dbo.GcDesign_Searches_CustomValue
WHERE
	[ArticleID] = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCustomValueByField]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCustomValueByField]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetCustomValueByField]
	@ArticleID [int],
	@CustomFieldID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	[CustomValueID],
	[ArticleID],
	[CustomFieldID],
	[CustomValue]
FROM dbo.GcDesign_Searches_CustomValue
WHERE
	[ArticleID] = @ArticleID
	and
	[CustomFieldID] = @CustomFieldID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCustomFieldList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCustomFieldList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetCustomFieldList]
	@ModuleID [int]
WITH EXECUTE AS CALLER
AS
SELECT     
      CustomFieldID, 
      ModuleID, 
      [Name], 
      FieldType, 
      FieldElements, 
      DefaultValue, 
      Caption, 
      CaptionHelp, 
      IsRequired, 
      IsVisible, 
      SortOrder, 
      ValidationType, 
    RegularExpression, 
      [Length]
FROM         
      dbo.GcDesign_Searches_CustomField
WHERE
      [ModuleID] = @ModuleID
ORDER BY
	SortOrder' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCustomField]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCustomField]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetCustomField]
	@CustomFieldID [int]
WITH EXECUTE AS CALLER
AS
SELECT     
      CustomFieldID, 
      ModuleID, 
      [Name], 
      FieldType, 
      FieldElements, 
      DefaultValue, 
      Caption, 
      CaptionHelp, 
      IsRequired, 
      IsVisible, 
      SortOrder, 
      ValidationType, 
    RegularExpression, 
      [Length]
FROM         
      dbo.GcDesign_Searches_CustomField
WHERE
      [CustomFieldID] = @CustomFieldID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FileUpdate]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FileUpdate]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FileUpdate]
	@FileID [int],
	@ArticleID [int],
	@Title [nvarchar](255),
	@FileName [nvarchar](255),
	@Extension [nvarchar](200),
	@Size [int],
	@ContentType [nvarchar](200),
	@Folder [nvarchar](255),
	@SortOrder [int],
	@FileGuid [nvarchar](50)
WITH EXECUTE AS CALLER
AS
UPDATE
	dbo.GcDesign_Searches_File
SET
	[ArticleID] = @ArticleID,
	[Title] = @Title,
	[FileName] = @FileName,
	[Extension] = @Extension,
	[Size] = @Size,
	[ContentType] = @ContentType,
	[Folder] = @Folder,
	[SortOrder] = @SortOrder,
	[FileGuid] = @FileGuid
WHERE
	[FileID] = @FileID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FileList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FileList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FileList]
	@ArticleID [int],
	@FileGuid [nvarchar](50)
WITH EXECUTE AS CALLER
AS
SELECT     
	FileID, 
	ArticleID, 
	Title, 
	FileName, 
	Extension, 
	Size, 
	ContentType, 
	Folder, 
	SortOrder, 
	FileGuid
FROM         
	dbo.GcDesign_Searches_File 
WHERE
	(@ArticleID IS NULL OR ArticleID = @ArticleID) 
	AND
	(@FileGuid IS NULL OR FileGuid = @FileGuid) 
ORDER BY 
	SortOrder' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FileGet]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FileGet]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FileGet]
	@FileID [int]
WITH EXECUTE AS CALLER
AS
SELECT     
	FileID, 
	ArticleID, 
	Title, 
	FileName, 
	Extension, 
	Size, 
	ContentType, 
	Folder, 
	SortOrder, 
	FileGuid
FROM         
	dbo.GcDesign_Searches_File
WHERE
	FileID = @FileID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FileDelete]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FileDelete]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FileDelete]
	@FileID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM dbo.GcDesign_Searches_File WHERE FileID = @FileID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FileAdd]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FileAdd]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FileAdd]
	@ArticleID [int],
	@Title [nvarchar](255),
	@FileName [nvarchar](255),
	@Extension [nvarchar](200),
	@Size [int],
	@ContentType [nvarchar](200),
	@Folder [nvarchar](255),
	@SortOrder [int],
	@FileGuid [nvarchar](50)
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_File (
	[ArticleID],
	[Title],
	[FileName],
	[Extension],
	[Size],
	[ContentType],
	[Folder],
	[SortOrder],
	[FileGuid]
) VALUES (
	@ArticleID,
	@Title,
	@FileName,
	@Extension,
	@Size,
	@ContentType,
	@Folder,
	@SortOrder,
	@FileGuid 
)

select SCOPE_IDENTITY()' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedCategoryDelete]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedCategoryDelete]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FeedCategoryDelete]
	@FeedID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM dbo.GcDesign_Searches_FeedCategory
WHERE FeedID = @FeedID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedCategoryAdd]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedCategoryAdd]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FeedCategoryAdd]
	@FeedID [int],
	@CategoryID [int]
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_FeedCategory(FeedID, CategoryID)
	VALUES(@FeedID, @CategoryID)' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_EmailTemplateUpdate]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplateUpdate]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_EmailTemplateUpdate]
	@TemplateID [int],
	@ModuleID [int],
	@Name [nvarchar](50),
	@Subject [nvarchar](255),
	@Template [ntext]
WITH EXECUTE AS CALLER
AS
UPDATE dbo.GcDesign_Searches_EmailTemplate SET
	[ModuleID] = @ModuleID,
	[Name] = @Name,
	[Subject] = @Subject,
	[Template] = @Template
WHERE
	[TemplateID] = @TemplateID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_EmailTemplateList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplateList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_EmailTemplateList]
	@ModuleID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	[TemplateID],
	[ModuleID],
	[Name],
	[Subject],
	[Template]
FROM dbo.GcDesign_Searches_EmailTemplate
WHERE
	[ModuleID] = @ModuleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_EmailTemplateGetByName]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplateGetByName]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_EmailTemplateGetByName]
	@ModuleID [int],
	@Name [nvarchar](50)
WITH EXECUTE AS CALLER
AS
SELECT
	[TemplateID],
	[ModuleID],
	[Name],
	[Subject],
	[Template]
FROM dbo.GcDesign_Searches_EmailTemplate
WHERE
	[ModuleID] = @ModuleID
	and
	[Name] = @Name' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_EmailTemplateGet]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplateGet]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_EmailTemplateGet]
	@TemplateID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	[TemplateID],
	[ModuleID],
	[Name],
	[Subject],
	[Template]
FROM dbo.GcDesign_Searches_EmailTemplate
WHERE
	[TemplateID] = @TemplateID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_EmailTemplateDelete]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplateDelete]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_EmailTemplateDelete]
	@TemplateID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM dbo.GcDesign_Searches_EmailTemplate
WHERE
	[TemplateID] = @TemplateID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_EmailTemplateAdd]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_EmailTemplateAdd]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_EmailTemplateAdd]
	@ModuleID [int],
	@Name [nvarchar](50),
	@Subject [nvarchar](255),
	@Template [ntext]
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_EmailTemplate (
	[ModuleID],
	[Name],
	[Subject],
	[Template]
) VALUES (
	@ModuleID,
	@Name,
	@Subject,
	@Template
)

select SCOPE_IDENTITY()' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedAdd]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedAdd]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FeedAdd]
	@ModuleID [int],
	@Title [nvarchar](255),
	@Url [nvarchar](255),
	@UserID [int],
	@AutoFeature [bit],
	@IsActive [bit],
	@DateMode [int],
	@AutoExpire [int],
	@AutoExpireUnit [int]
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_Feed (
	[ModuleID],
	[Title],
	[Url],
	[UserID],
	[AutoFeature],
	[IsActive],
	[DateMode],
	[AutoExpire],
	[AutoExpireUnit]  
) VALUES (
	@ModuleID,
	@Title,
	@Url,
	@UserID,
	@AutoFeature,
	@IsActive,
	@DateMode,
	@AutoExpire,
	@AutoExpireUnit 
)

select SCOPE_IDENTITY()' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ArticleTagDeleteByTag]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleTagDeleteByTag]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_ArticleTagDeleteByTag]
	@TagID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM dbo.GcDesign_Searches_ArticleTag 
WHERE TagID = @TagID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ArticleTagDelete]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleTagDelete]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_ArticleTagDelete]
	@ArticleID [int]
WITH EXECUTE AS CALLER
AS
UPDATE 
	dbo.GcDesign_Searches_Tag 
SET
	Usages = Usages - 1
WHERE
	TagID in (SELECT pt.TagID from dbo.GcDesign_Searches_ArticleTag pt where ArticleID = @ArticleID)

DELETE FROM dbo.GcDesign_Searches_Tag 
WHERE Usages = 0

DELETE FROM dbo.GcDesign_Searches_ArticleTag 
WHERE ArticleID = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_ArticleTagAdd]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleTagAdd]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_ArticleTagAdd]
	@ArticleID [int],
	@TagID [int]
WITH EXECUTE AS CALLER
AS
IF( (SELECT COUNT(*) FROM dbo.GcDesign_Searches_ArticleTag WHERE ArticleID = @ArticleID and TagID = @TagID) = 0 )
BEGIN
	INSERT INTO 
		dbo.GcDesign_Searches_ArticleTag(ArticleID, TagID)
	VALUES(@ArticleID, @TagID) 

	UPDATE
		dbo.GcDesign_Searches_Tag
	SET
		Usages = (select count(*) from dbo.GcDesign_Searches_ArticleTag pt where pt.TagID = @TagID) 
	WHERE
		TagID = @TagID
END' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedUpdate]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedUpdate]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FeedUpdate]
	@FeedID [int],
	@ModuleID [int],
	@Title [nvarchar](255),
	@Url [nvarchar](255),
	@UserID [int],
	@AutoFeature [bit],
	@IsActive [bit],
	@DateMode [int],
	@AutoExpire [int],
	@AutoExpireUnit [int]
WITH EXECUTE AS CALLER
AS
UPDATE
	dbo.GcDesign_Searches_Feed 
SET 
	[ModuleID] = @ModuleID,
	[Title] = @Title,
	[Url] = @Url, 
	[UserID] = @UserID, 
	[AutoFeature] = @AutoFeature, 
	[IsActive] = @IsActive,
	[DateMode] = @DateMode,
	[AutoExpire] = @AutoExpire,
	[AutoExpireUnit] = @AutoExpireUnit  
WHERE
	[FeedID] = @FeedID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FeedList]
	@ModuleID [int],
	@ShowActiveOnly [bit]
WITH EXECUTE AS CALLER
AS
SELECT     
	FeedID, 
	ModuleID, 
	Title, 
	Url, 
	UserID, 
	AutoFeature, 
	IsActive,
	DateMode,
	AutoExpire,
	AutoExpireUnit  
FROM         
	dbo.GcDesign_Searches_Feed
WHERE
	(@ModuleID = -1 OR ModuleID = @ModuleID) 
	AND 
	(@ShowActiveOnly = 0 OR IsActive = 1)
ORDER BY 
	Title' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedGet]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedGet]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FeedGet]
	@FeedID [int]
WITH EXECUTE AS CALLER
AS
SELECT     
	FeedID, 
	ModuleID, 
	Title, 
	Url, 
	UserID, 
	AutoFeature, 
	IsActive,
	DateMode,
	AutoExpire,
	AutoExpireUnit  
FROM         
	dbo.GcDesign_Searches_Feed
WHERE
	FeedID = @FeedID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedDelete]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedDelete]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FeedDelete]
	@FeedID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM dbo.GcDesign_Searches_Feed
WHERE
	[FeedID] = @FeedID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteHandoutArticleList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteHandoutArticleList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_DeleteHandoutArticleList]
	@HandoutID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM         
	dbo.GcDesign_Searches_HandoutArticle
WHERE
	HandoutID = @HandoutID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteHandout]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteHandout]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_DeleteHandout]
	@HandoutID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM         
	dbo.GcDesign_Searches_Handout
WHERE
	HandoutID = @HandoutID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteCustomValue]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteCustomValue]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_DeleteCustomValue]
	@ArticleID [int],
	@CustomFieldID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM dbo.GcDesign_Searches_CustomValue
WHERE
	[ArticleID] = @ArticleID AND 
	[CustomFieldID] = @CustomFieldID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteCustomField]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteCustomField]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_DeleteCustomField]
	@CustomFieldID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM 
	dbo.GcDesign_Searches_CustomValue
WHERE
	CustomFieldID = @CustomFieldID

DELETE FROM 
	dbo.GcDesign_Searches_CustomField
WHERE
	CustomFieldID = @CustomFieldID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddMirrorArticle]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddMirrorArticle]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_AddMirrorArticle]
	@ArticleID [int],
	@LinkedArticleID [int],
	@LinkedPortalID [int],
	@AutoUpdate [bit]
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_Mirror (
	[ArticleID],
	[LinkedArticleID],
	[LinkedPortalID],
	[AutoUpdate] 
) VALUES (
	@ArticleID, 
	@LinkedArticleID, 
	@LinkedPortalID, 
	@AutoUpdate  
)' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddHandoutArticle]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddHandoutArticle]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_AddHandoutArticle]
	@HandoutID [int],
	@ArticleID [int],
	@SortOrder [int]
WITH EXECUTE AS CALLER
AS
INSERT INTO
	dbo.GcDesign_Searches_HandoutArticle(HandoutID, ArticleID, SortOrder)
VALUES
	(@HandoutID, @ArticleID, @SortOrder)' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddHandout]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddHandout]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_AddHandout]
	@ModuleID [int],
	@UserID [int],
	@Name [nvarchar](255),
	@Description [ntext]
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_Handout (
	[ModuleID],
	[UserID],
	[Name],
	[Description]
) VALUES (
	@ModuleID,
	@UserID,
	@Name,
	@Description
)

select SCOPE_IDENTITY()' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddCustomValue]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddCustomValue]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_AddCustomValue]
	@ArticleID [int],
	@CustomFieldID [int],
	@CustomValue [ntext]
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_CustomValue (
	[ArticleID],
	[CustomFieldID],
	[CustomValue]
) VALUES (
	@ArticleID,
	@CustomFieldID,
	@CustomValue
)

select SCOPE_IDENTITY()' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddCustomField]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddCustomField]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_AddCustomField]
	@ModuleID [int],
	@Name [nvarchar](255),
	@FieldType [int],
	@FieldElements [ntext],
	@DefaultValue [nvarchar](255),
	@Caption [nvarchar](255),
	@CaptionHelp [nvarchar](255),
	@IsRequired [bit],
	@IsVisible [bit],
	@SortOrder [int],
	@ValidationType [int],
	@Length [int],
	@RegularExpression [nvarchar](4000)
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_CustomField (
	[ModuleID],
	[Name],
	[FieldType],
	[FieldElements],
	[DefaultValue],
	[Caption],
	[CaptionHelp],
	[IsRequired],
	[IsVisible],
	[SortOrder],
	[ValidationType],
	[Length],
	[RegularExpression]
) VALUES (
	@ModuleID,
	@Name,
	@FieldType,
	@FieldElements,
	@DefaultValue,
	@Caption,
	@CaptionHelp,
	@IsRequired,
	@IsVisible,
	@SortOrder,
	@ValidationType,
	@Length,
	@RegularExpression
)

select SCOPE_IDENTITY()' 
    END
GO

/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_TagDelete]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_TagDelete]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_TagDelete]
	@TagID [int]
WITH EXECUTE AS CALLER
AS
exec dbo.GcDesign_Searches_ArticleTagDeleteByTag @TagID

DELETE FROM dbo.GcDesign_Searches_Tag
WHERE
	[TagID] = @TagID' 
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Category]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Category]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_Category]
            (
              [CategoryID] [INT] IDENTITY(1, 1)
                                 NOT NULL ,
              [ModuleID] [INT] NOT NULL ,
              [Name] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                     NOT NULL ,
              [Image] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                      NULL ,
              [ParentID] [INT] NULL ,
              [Description] [NTEXT] COLLATE Chinese_PRC_CI_AS
                                    NULL ,
              [SortOrder] [INT] NULL ,
              [InheritSecurity] [BIT] NOT NULL ,
              [CategorySecurityType] [INT] NOT NULL ,
              [MetaTitle] [NVARCHAR](200) COLLATE Chinese_PRC_CI_AS
                                          NULL ,
              [MetaDescription] [NVARCHAR](500) COLLATE Chinese_PRC_CI_AS
                                                NULL ,
              [MetaKeywords] [NVARCHAR](500) COLLATE Chinese_PRC_CI_AS
                                             NULL ,
              CONSTRAINT [PK_GcDesign_Searches_Category] PRIMARY KEY CLUSTERED
                ( [CategoryID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY] TEXTIMAGE_ON [PRIMARY]
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Article]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Article]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_Article]
            (
              [ArticleID] [INT] IDENTITY(1, 1)
                                NOT NULL ,
              [AuthorID] [INT] NOT NULL ,
              [ApproverID] [INT] NULL ,
              [CreatedDate] [DATETIME] NOT NULL ,
              [LastUpdate] [DATETIME] NOT NULL ,
              [Title] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                      NOT NULL ,
              [IsApproved] [BIT] NOT NULL ,
              [NumberOfViews] [INT] NOT NULL ,
              [IsDraft] [BIT] NOT NULL ,
              [StartDate] [DATETIME] NULL ,
              [EndDate] [DATETIME] NULL ,
              [ModuleID] [INT] NULL ,
              [ImageUrl] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                         NULL ,
              [IsFeatured] [BIT] NOT NULL ,
              [LastUpdateID] [INT] NULL ,
              [URL] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                    NULL ,
              [IsSecure] [INT] NOT NULL ,
              [IsNewWindow] [BIT] NOT NULL ,
              [Summary] [NTEXT] COLLATE Chinese_PRC_CI_AS
                                NULL ,
              [CommentCount] [INT] NULL ,
              [PageCount] [INT] NULL ,
              [Rating] [DECIMAL](3, 2) NULL ,
              [RatingCount] [INT] NULL ,
              [MetaTitle] [NVARCHAR](200) COLLATE Chinese_PRC_CI_AS
                                          NULL ,
              [MetaDescription] [NVARCHAR](500) COLLATE Chinese_PRC_CI_AS
                                                NULL ,
              [MetaKeywords] [NVARCHAR](500) COLLATE Chinese_PRC_CI_AS
                                             NULL ,
              [PageHeadText] [NVARCHAR](500) COLLATE Chinese_PRC_CI_AS
                                             NULL ,
              [ShortUrl] [NVARCHAR](50) COLLATE Chinese_PRC_CI_AS
                                        NULL ,
              [RssGuid] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                        NULL ,
              [ImageCount] [INT] NULL ,
              [FileCount] [INT] NULL ,
              CONSTRAINT [PK_GcDesign_Searches_Article] PRIMARY KEY CLUSTERED
                ( [ArticleID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY] TEXTIMAGE_ON [PRIMARY]
    END
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.indexes
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Article]')
                        AND name = N'_dta_index_GcDesign_Searches_Article' )
    CREATE NONCLUSTERED INDEX [_dta_index_GcDesign_Searches_Article] ON [dbo].[GcDesign_Searches_Article] 
    (
    [ModuleID] ASC,
    [ArticleID] ASC,
    [IsApproved] ASC,
    [IsDraft] ASC,
    [EndDate] ASC,
    [StartDate] ASC
    )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.indexes
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Article]')
                        AND name = N'_dta_index_GcDesign_Searches_Article_Status' )
    CREATE NONCLUSTERED INDEX [_dta_index_GcDesign_Searches_Article_Status] ON [dbo].[GcDesign_Searches_Article] 
    (
    [ArticleID] ASC,
    [IsDraft] ASC,
    [IsApproved] ASC
    )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.indexes
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Article]')
                        AND name = N'_dta_index_GcDesign_Searches_Article_Views' )
    CREATE NONCLUSTERED INDEX [_dta_index_GcDesign_Searches_Article_Views] ON [dbo].[GcDesign_Searches_Article] 
    (
    [ArticleID] ASC
    )
    INCLUDE ( [NumberOfViews]) WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_ArticleCategories]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleCategories]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_ArticleCategories]
            (
              [ArticleID] [INT] NOT NULL ,
              [CategoryID] [INT] NOT NULL ,
              CONSTRAINT [PK_GcDesign_Searches_ArticleCategories] PRIMARY KEY CLUSTERED
                ( [ArticleID] ASC, [CategoryID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY]
    END
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.indexes
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleCategories]')
                        AND name = N'_dta_index_GcDesign_Searches_Articl_5_160719625__K2' )
    CREATE NONCLUSTERED INDEX [_dta_index_GcDesign_Searches_Articl_5_160719625__K2] ON [dbo].[GcDesign_Searches_ArticleCategories] 
    (
    [CategoryID] ASC
    )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.indexes
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleCategories]')
                        AND name = N'_dta_index_GcDesign_Searches_Article_Category' )
    CREATE NONCLUSTERED INDEX [_dta_index_GcDesign_Searches_Article_Category] ON [dbo].[GcDesign_Searches_ArticleCategories] 
    (
    [ArticleID] ASC,
    [CategoryID] ASC
    )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Comment]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_Comment]
            (
              [CommentID] [INT] IDENTITY(1, 1)
                                NOT NULL ,
              [ArticleID] [INT] NOT NULL ,
              [UserID] [INT] NOT NULL ,
              [CreatedDate] [DATETIME] NOT NULL ,
              [Comment] [NTEXT] COLLATE Chinese_PRC_CI_AS
                                NOT NULL ,
              [RemoteAddress] [NVARCHAR](50) COLLATE Chinese_PRC_CI_AS
                                             NULL ,
              [Type] [INT] NOT NULL ,
              [TrackbackUrl] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                             NULL ,
              [TrackbackTitle] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                               NULL ,
              [TrackbackBlogName] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                                  NULL ,
              [TrackbackExcerpt] [NTEXT] COLLATE Chinese_PRC_CI_AS
                                         NULL ,
              [AnonymousName] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                              NULL ,
              [AnonymousEmail] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                               NULL ,
              [AnonymousURL] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                             NULL ,
              [NotifyMe] [BIT] NOT NULL ,
              [isApproved] [BIT] NOT NULL ,
              [approvedBy] [INT] NULL ,
              CONSTRAINT [PK_GcDesign_Searches_Comment] PRIMARY KEY CLUSTERED
                ( [CommentID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY] TEXTIMAGE_ON [PRIMARY]
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_Category_MoveNodeBefore]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Category_MoveNodeBefore]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_Category_MoveNodeBefore]
	@SourceOrgID [int],
	@TargetOrgID [int],
	@ParentID [int],
	@SortOrder [int]
WITH EXECUTE AS CALLER
AS
UPDATE  dbo.GcDesign_Searches_Category
    SET     ParentID = @ParentID ,
            SortOrder = @SortOrder
    WHERE   CategoryID = @SourceOrgID

    UPDATE  dbo.GcDesign_Searches_Category
    SET     SortOrder = SortOrder + 1
    WHERE   CategoryID = @TargetOrgID
            OR ( ParentID = @ParentID
                 AND SortOrder > @SortOrder
                 AND CategoryID != @TargetOrgID
               )
' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_FeedCategoryList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_FeedCategoryList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_FeedCategoryList]
	@FeedID [int]
WITH EXECUTE AS CALLER
AS
SELECT     
	c.[CategoryID],
	c.[ParentID], 
	c.[ModuleID],
	c.[Name],
	c.[Image],
	c.[Description],
	c.[SortOrder] 
FROM         
	dbo.GcDesign_Searches_FeedCategory fc INNER JOIN
		dbo.GcDesign_Searches_Category c ON fc.categoryID = c.categoryID 
WHERE
	fc.FeedID = @FeedID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddCategory]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddCategory]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_AddCategory]
	@ModuleID [int],
	@ParentID [int],
	@Name [nvarchar](255),
	@Image [nvarchar](255),
	@Description [ntext],
	@SortOrder [int],
	@InheritSecurity [bit],
	@CategorySecurityType [bit],
	@MetaTitle [nvarchar](200),
	@MetaDescription [nvarchar](500),
	@MetaKeywords [nvarchar](500)
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_Category (
	[ModuleID],
	[ParentID],
	[Name],
	[Image],
	[Description],
	[SortOrder],
	[InheritSecurity],
	[CategorySecurityType],
	[MetaTitle],
	[MetaDescription],
	[MetaKeywords]
) VALUES (
	@ModuleID,
	@ParentID,
	@Name,
	@Image,
	@Description,
	@SortOrder,
	@InheritSecurity,
	@CategorySecurityType,
	@MetaTitle,
	@MetaDescription,
	@MetaKeywords
)

select SCOPE_IDENTITY()' 
    END
GO
/****** Object:  Table [dbo].[GcDesign_Searches_Page]    Script Date: 04/19/2015 21:16:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Page]')
                        AND type IN ( N'U' ) )
    BEGIN
        CREATE TABLE [dbo].[GcDesign_Searches_Page]
            (
              [PageID] [INT] IDENTITY(1, 1)
                             NOT NULL ,
              [ArticleID] [INT] NOT NULL ,
              [Title] [NVARCHAR](255) COLLATE Chinese_PRC_CI_AS
                                      NOT NULL ,
              [PageText] [NVARCHAR](MAX) COLLATE Chinese_PRC_CI_AS
                                         NULL ,
              [SortOrder] [INT] NOT NULL ,
              CONSTRAINT [PK_GcDesign_Searches_Page] PRIMARY KEY CLUSTERED
                ( [PageID] ASC )
                WITH ( PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF,
                       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,
                       ALLOW_PAGE_LOCKS = ON ) ON [PRIMARY]
            )
        ON  [PRIMARY]
    END
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.indexes
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Page]')
                        AND name = N'_dta_index_GcDesign_Searches_Page' )
    CREATE NONCLUSTERED INDEX [_dta_index_GcDesign_Searches_Page] ON [dbo].[GcDesign_Searches_Page] 
    (
    [SortOrder] ASC,
    [ArticleID] ASC
    )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetMirrorArticleList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetMirrorArticleList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetMirrorArticleList]
	@LinkedArticleID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	m.[ArticleID],
	m.[LinkedArticleID],
	m.[LinkedPortalID],
	m.[AutoUpdate],
	mo.[PortalID]      
FROM
	dbo.GcDesign_Searches_Mirror m INNER JOIN
		dbo.GcDesign_Searches_Article a ON m.ArticleID = a.ArticleID INNER JOIN
		dbo.Modules mo ON a.ModuleID = mo.ModuleID 
WHERE
	m.[LinkedArticleID] = @LinkedArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCategoryList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCategoryList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetCategoryList]
	@ModuleID [int],
	@ParentID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	[CategoryID],
	[ParentID],
	[ModuleID],
	[Name],
	[Image],
	[Description],
	[SortOrder],
	[InheritSecurity],
	[CategorySecurityType],
	[MetaTitle],
	[MetaDescription],
	[MetaKeywords]      
FROM
	dbo.GcDesign_Searches_Category
WHERE
	[ModuleID] = @ModuleID
	AND
	[ParentID] = @ParentID
ORDER BY 
	[SortOrder], [Name]' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCategory]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCategory]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetCategory]
	@CategoryID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	[CategoryID],
	[ParentID], 
	[ModuleID],
	[Name],
	[Image],
	[Description],
	[SortOrder],
	[InheritSecurity],
	[CategorySecurityType],
	[MetaTitle],
	[MetaDescription],
	[MetaKeywords]
FROM
	dbo.GcDesign_Searches_Category
WHERE
	[CategoryID] = @CategoryID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetAuthorList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetAuthorList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetAuthorList]
	@ModuleID [int]
WITH EXECUTE AS CALLER
AS
SELECT DISTINCT 
	Authors.UserID, 
	Authors.Username, 
	Authors.FirstName, 
	Authors.LastName,
	Authors.DisplayName 

FROM         
	dbo.GcDesign_Searches_Article Articles, dbo.Users Authors

WHERE
	Articles.AuthorID = Authors.UserID
	and
	Articles.ModuleID = @ModuleID
	and 
	Articles.IsApproved = 1

ORDER BY
	Authors.FirstName, Authors.LastName' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_RatingDelete]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_RatingDelete]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_RatingDelete]
	@RatingID [int]
WITH EXECUTE AS CALLER
AS
DECLARE @ArticleID int
SELECT @ArticleID = ArticleID FROM dbo.GcDesign_Searches_Rating WHERE [RatingID] = @RatingID

DELETE FROM dbo.GcDesign_Searches_Rating
WHERE [RatingID] = @RatingID

UPDATE dbo.GcDesign_Searches_Article
SET [Rating] = (select AVG(rating) from dbo.GcDesign_Searches_Rating Rating where Rating.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = @ArticleID 

UPDATE dbo.GcDesign_Searches_Article
SET [RatingCount] = (select COUNT(*) from dbo.GcDesign_Searches_Rating Rating where Rating.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_RatingAdd]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_RatingAdd]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_RatingAdd]
	@ArticleID [int],
	@UserID [int],
	@CreatedDate [datetime],
	@Rating [float]
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_Rating (
	[ArticleID],
	[UserID],
	[CreatedDate],
	[Rating]
) VALUES (
	@ArticleID,
	@UserID,
	@CreatedDate,
	@Rating
)

select SCOPE_IDENTITY()

UPDATE dbo.GcDesign_Searches_Article
SET [Rating] = (select AVG(rating) from dbo.GcDesign_Searches_Rating Rating where Rating.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = @ArticleID 

UPDATE dbo.GcDesign_Searches_Article
SET [Rating] = (select AVG(rating) from dbo.GcDesign_Searches_Rating Rating where Rating.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = @ArticleID 

UPDATE dbo.GcDesign_Searches_Article
SET [RatingCount] = (select COUNT(*) from dbo.GcDesign_Searches_Rating Rating where Rating.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateCategory]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateCategory]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_UpdateCategory]
	@CategoryID [int],
	@ModuleID [int],
	@ParentID [int],
	@Name [nvarchar](255),
	@Image [nvarchar](255),
	@Description [ntext],
	@SortOrder [int],
	@InheritSecurity [bit],
	@CategorySecurityType [int],
	@MetaTitle [nvarchar](200),
	@MetaDescription [nvarchar](500),
	@MetaKeywords [nvarchar](500)
WITH EXECUTE AS CALLER
AS
UPDATE dbo.GcDesign_Searches_Category SET
	[ModuleID] = @ModuleID,
	[ParentID] = @ParentID, 
	[Name] = @Name,
	[Image] = @Image,
	[Description] = @Description,
	[SortOrder] = @SortOrder,
	[InheritSecurity] = @InheritSecurity,
	[CategorySecurityType] = @CategorySecurityType,
	[MetaTitle] = @MetaTitle,
	[MetaDescription] = @MetaDescription,
	[MetaKeywords] = @MetaKeywords   
WHERE
	[CategoryID] = @CategoryID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateArticleCount]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateArticleCount]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_UpdateArticleCount]
	@ArticleID [int],
	@NumberOfViews [int]
WITH EXECUTE AS CALLER
AS
UPDATE 
		dbo.GcDesign_Searches_Article 
	SET
		[NumberOfViews] = @NumberOfViews 
	WHERE
		[ArticleID] = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdatePage]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdatePage]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_UpdatePage]
	@PageID [int],
	@ArticleID [int],
	@Title [nvarchar](255),
	@PageText [nvarchar](max),
	@SortOrder [int]
WITH EXECUTE AS CALLER
AS
UPDATE dbo.GcDesign_Searches_Page SET
	[ArticleID] = @ArticleID,
	[Title] = @Title, 
	[PageText] = @PageText,
	[SortOrder] = @SortOrder
WHERE
	[PageID] = @PageID

UPDATE dbo.GcDesign_Searches_Article
SET [PageCount] = (select count(*) from dbo.GcDesign_Searches_Page Page where Page.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE ArticleID = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateArticle]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateArticle]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_UpdateArticle]
	@ArticleID [int],
	@AuthorID [int],
	@ApproverID [int],
	@CreatedDate [datetime],
	@LastUpdate [datetime],
	@Title [nvarchar](255),
	@Summary [ntext],
	@IsApproved [bit],
	@NumberOfViews [int],
	@IsDraft [bit],
	@StartDate [datetime],
	@EndDate [datetime],
	@ModuleID [int],
	@ImageUrl [nvarchar](255),
	@IsFeatured [bit],
	@LastUpdateID [int],
	@Url [nvarchar](255),
	@IsSecure [bit],
	@IsNewWindow [bit],
	@MetaTitle [nvarchar](200),
	@MetaDescription [nvarchar](500),
	@MetaKeywords [nvarchar](500),
	@PageHeadText [nvarchar](500),
	@ShortUrl [nvarchar](50),
	@RssGuid [nvarchar](255)
WITH EXECUTE AS CALLER
AS
UPDATE dbo.GcDesign_Searches_Article SET
	[AuthorID] = @AuthorID,
	[ApproverID] = @ApproverID,
	[CreatedDate] = @CreatedDate,
	[LastUpdate] = @LastUpdate,
	[Title] = @Title,
	[Summary] = @Summary,
	[IsApproved] = @IsApproved,
	[NumberOfViews] = @NumberOfViews,
	[IsDraft] = @IsDraft,
	[StartDate] = @StartDate,
	[EndDate] = @EndDate,
	[ModuleID] = @ModuleID,
	[ImageUrl] = @ImageUrl,
	[IsFeatured] = @IsFeatured, 
	[LastUpdateID] = @LastUpdateID, 
	[Url] = @Url,
	[IsSecure] = @IsSecure,
	[IsNewWindow] = @IsNewWindow,
	[MetaTitle] = @MetaTitle,
	[MetaDescription] = @MetaDescription,
	[MetaKeywords] = @MetaKeywords,
	[PageHeadText] = @PageHeadText,
	[ShortUrl] = @ShortUrl,
	[RssGuid] = @RssGuid      
WHERE
	[ArticleID] = @ArticleID

UPDATE dbo.GcDesign_Searches_Article
SET [PageCount] = (select count(*) from dbo.GcDesign_Searches_Page Page where Page.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE ArticleID = @ArticleID

UPDATE dbo.GcDesign_Searches_Article
SET [CommentCount] = (select count(*) from dbo.GcDesign_Searches_Comment Comment where Comment.ArticleID = dbo.GcDesign_Searches_Article.ArticleID and Comment.IsApproved = 1)
WHERE ArticleID = @ArticleID

UPDATE dbo.GcDesign_Searches_Article
SET [Rating] = (select AVG(rating) from dbo.GcDesign_Searches_Rating Rating where Rating.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = @ArticleID

UPDATE dbo.GcDesign_Searches_Article
SET [RatingCount] = (select COUNT(*) from dbo.GcDesign_Searches_Rating Rating where Rating.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = @ArticleID

UPDATE dbo.GcDesign_Searches_Article
SET [ImageCount] = (select COUNT(*) from dbo.GcDesign_Searches_Image i where i.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = @ArticleID 

UPDATE dbo.GcDesign_Searches_Article
SET [FileCount] = (select COUNT(*) from dbo.GcDesign_Searches_File f where f.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_UpdateComment]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_UpdateComment]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_UpdateComment]
	@CommentID [int],
	@ArticleID [int],
	@UserID [int],
	@Comment [ntext],
	@RemoteAddress [nvarchar](50),
	@Type [int],
	@TrackbackUrl [nvarchar](255),
	@TrackbackTitle [nvarchar](255),
	@TrackbackBlogName [nvarchar](255),
	@TrackbackExcerpt [ntext],
	@AnonymousName [nvarchar](255),
	@AnonymousEmail [nvarchar](255),
	@AnonymousURL [nvarchar](255),
	@NotifyMe [bit],
	@IsApproved [bit],
	@ApprovedBy [int]
WITH EXECUTE AS CALLER
AS
UPDATE dbo.GcDesign_Searches_Comment SET
	[ArticleID] = @ArticleID,
	[UserID] = @UserID, 
	[Comment] = @Comment,
	[RemoteAddress] = @RemoteAddress,
	[Type] = @Type,
	[TrackbackUrl] = @TrackbackUrl,
	[TrackbackTitle] = @TrackbackTitle,
	[TrackbackBlogName] = @TrackbackBlogName,
	[TrackbackExcerpt] = @TrackbackExcerpt,
	[AnonymousName] = @AnonymousName,
	[AnonymousEmail] = @AnonymousEmail,
	[AnonymousURL] = @AnonymousURL,
	[NotifyMe] = @NotifyMe,
	[IsApproved] = @IsApproved,
	[ApprovedBy] = @ApprovedBy 
WHERE
	[CommentID] = @CommentID

UPDATE dbo.GcDesign_Searches_Article
SET [CommentCount] = (select count(*) from dbo.GcDesign_Searches_Comment Comment where Comment.ArticleID = dbo.GcDesign_Searches_Article.ArticleID and Comment.IsApproved = 1)
WHERE ArticleID = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetArticleListBySearchCriteria1]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetArticleListBySearchCriteria1]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetArticleListBySearchCriteria1]
	@ModuleID [int],
	@EndDate [datetime],
	@StartDate [datetime],
	@CategoryID [varchar](2000),
	@CategoryIDCount [int],
	@CategoryIDExclude [varchar](2000),
	@MaxCount [int],
	@PageNumber [int],
	@PageSize [int],
	@SortBy [varchar](50),
	@SortDirection [varchar](50),
	@IsApproved [bit],
	@IsDraft [bit],
	@KeyWords [nvarchar](255),
	@AuthorID [int],
	@ShowPending [bit],
	@ShowExpired [bit],
	@ShowFeaturedOnly [bit],
	@ShowNotFeaturedOnly [bit],
	@ShowSecuredOnly [bit],
	@ShowNotSecuredOnly [bit],
	@ArticleIDs [varchar](255),
	@TagID [varchar](2000),
	@TagIDCount [int],
	@RssGuid [nvarchar](255),
	@CustomFieldID [int],
	@CustomValue [nvarchar](255),
	@LinkFilter [nvarchar](255)
WITH EXECUTE AS CALLER
AS
-- Form Where Query
--组织查询语句
DECLARE @strWhere	nvarchar(4000)
SELECT @strWhere = ''Article.ModuleID = '' + convert(nvarchar, @ModuleId)
--当前日期
IF( @EndDate is null )
	SELECT @EndDate = GetDate()

IF( @ShowPending is null )--显示挂起的
BEGIN
	SELECT @strWhere = @strWhere + '' AND (Article.StartDate is null OR (Article.StartDate <= '''''' + CONVERT(char(24), @EndDate, 126)  + '''''' ))''
	
	IF( @StartDate is not null )--多少天前到 规定日期的（做多到今日）
		SELECT @strWhere = @strWhere + '' AND Article.StartDate >= '''''' + CONVERT(char(24), @StartDate, 126)  + ''''''''
END
ELSE
BEGIN
	IF( @StartDate is not null )--减去跨度的日期
			SELECT @strWhere = @strWhere + '' AND Article.StartDate >= '''''' + CONVERT(char(24), @StartDate, 126)  + ''''''''
END

IF( @ShowExpired is null )--下面不显示过期的
BEGIN
	SELECT @strWhere = @strWhere + '' AND (Article.EndDate is null OR Article.EndDate <= '''''' + CONVERT(char(24), @EndDate, 126)  + '''''')''
END

IF (@CategoryId is not null)
BEGIN
	IF(@CategoryIDCount is not null)
	BEGIN
		SELECT @strWhere = @strWhere + '' AND Article.ArticleID in ( select ArticleID from dbo.GcDesign_Searches_ArticleCategories where dbo.GcDesign_Searches_ArticleCategories.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleCategories.CategoryID in ('' + @CategoryID + '') group by articleID having count(*) > '' + convert(nvarchar, @CategoryIDCount) + '')''
	END
	ELSE
	BEGIN
		IF( CHARINDEX(''-1'', @CategoryID) = 0 )
		BEGIN
			SELECT @strWhere = @strWhere + '' AND Article.ArticleID in ( select ArticleID from dbo.GcDesign_Searches_ArticleCategories where dbo.GcDesign_Searches_ArticleCategories.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleCategories.CategoryID in ('' + @CategoryID + ''))''
		END
		ELSE
		BEGIN
			SELECT @strWhere = @strWhere + '' AND (Article.ArticleID in ( select ArticleID from dbo.GcDesign_Searches_ArticleCategories where dbo.GcDesign_Searches_ArticleCategories.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleCategories.CategoryID in ('' + @CategoryID + '')) OR  Article.ArticleID not in (select ArticleID from dbo.GcDesign_Searches_ArticleCategories))''
		END
	END
END

IF (@CategoryIDExclude is not null)
	SELECT @strWhere = @strWhere + '' AND Article.ArticleID not in ( select ArticleID from dbo.GcDesign_Searches_ArticleCategories where dbo.GcDesign_Searches_ArticleCategories.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleCategories.CategoryID in ('' + @CategoryIDExclude + ''))''

IF (@CategoryIDExclude is not null)
	SELECT @strWhere = @strWhere + '' AND Article.ArticleID not in ( select ArticleID from dbo.GcDesign_Searches_ArticleCategories where dbo.GcDesign_Searches_ArticleCategories.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleCategories.CategoryID in ('' + @CategoryIDExclude + ''))''

IF (@AuthorID is not null)
	SELECT @strWhere = @strWhere + '' AND Article.AuthorID = '' + convert(nvarchar, @AuthorID)

IF (@IsApproved = 1 )
	SELECT @strWhere = @strWhere + '' AND Article.IsApproved = 1''

IF (@IsApproved = 0 )
	SELECT @strWhere = @strWhere + '' AND Article.IsApproved = 0''

IF (@IsDraft = 0)
	SELECT @strWhere = @strWhere + '' AND Article.IsDraft = 0''

IF (@IsDraft = 1 )
	SELECT @strWhere = @strWhere + '' AND Article.IsDraft = 1''

IF (@ShowFeaturedOnly = 1 )
	SELECT @strWhere = @strWhere + '' AND Article.IsFeatured = 1''
	
IF (@ShowNotFeaturedOnly = 1 )
	SELECT @strWhere = @strWhere + '' AND Article.IsFeatured = 0''

IF (@ShowSecuredOnly = 1 )
	SELECT @strWhere = @strWhere + '' AND Article.IsSecure = 1''
	
IF (@ShowNotSecuredOnly = 1 )
	SELECT @strWhere = @strWhere + '' AND Article.IsSecure = 0''

IF (@Keywords is not null)
BEGIN
	IF( LEN(@Keywords) = 1 ) 
	BEGIN
		SELECT @strWhere = @strWhere + '' AND (Article.Title LIKE N'''''' + @Keywords + ''%'''')''
	END
	ELSE
	BEGIN
		SELECT @strWhere = @strWhere + '' AND (Article.Title LIKE N''''%'' + @Keywords + ''%'''' OR Article.Summary LIKE N''''%'' + @Keywords + ''%'''' OR ((select count(*) from dbo.GcDesign_Searches_Page Page where Page.ArticleID = Article.ArticleID and Page.PageText LIKE N''''%'' + @Keywords + ''%'''') > 0) OR ((select count(*) from dbo.GcDesign_Searches_CustomValue cv where cv.ArticleID = Article.ArticleID and cv.CustomValue LIKE N''''%'' + @Keywords + ''%'''') > 0))''
	END
END

IF (@CustomFieldID is not null AND @CustomValue is not null)
	SELECT @strWhere = @strWhere + '' AND Article.ArticleID IN (SELECT ArticleID FROM dbo.GcDesign_Searches_CustomValue cv WHERE cv.customFieldID = '' + convert(nvarchar, @CustomFieldID) + '' AND cv.CustomValue LIKE N''''%'' + @CustomValue + ''%'''')''

IF (@ArticleIDs is not null)
	SELECT @strWhere = @strWhere + '' AND Article.ArticleID in ('' + @ArticleIDs + '')''
	
IF (@SortBy = ''Title'') 
	SELECT @SortBy = ''Article.Title''

IF (@SortBy = ''IsFeatured DESC, Title'') 
	SELECT @SortBy = ''IsFeatured DESC, Article.Title''

IF (@TagID is not null)
	if(@TagIDCount is not null)
		SELECT @strWhere = @strWhere + '' AND Article.ArticleID in ( select ArticleID from dbo.GcDesign_Searches_ArticleTag where dbo.GcDesign_Searches_ArticleTag.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleTag.TagID in ('' + @TagID + '') group by articleID having count(*) > '' + convert(nvarchar, @TagIDCount) + '')''
	else
		SELECT @strWhere = @strWhere + '' AND Article.ArticleID in ( select ArticleID from dbo.GcDesign_Searches_ArticleTag where dbo.GcDesign_Searches_ArticleTag.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleTag.TagID in ('' + @TagID + ''))''

IF (@RssGuid is not null)
	SELECT @strWhere = @strWhere + '' AND Article.RssGuid = N'''''' + @RssGuid + ''''''''
	
IF (@LinkFilter is not null)
	SELECT @strWhere = @strWhere + '' AND Article.Url = N'''''' + @LinkFilter + ''''''''
	
-- Set Paging Options

IF( @PageNumber is null )
	SET @PageNumber = 1

IF( @PageSize is null )
	SET @PageSize = 100

SET @PageNumber = @PageNumber - 1

DECLARE @startRowIndex int
SET @startRowIndex = (@PageNumber * @PageSize)

DECLARE @maxRow int
SET @maxRow = (@startRowIndex + @PageSize)
IF( @MaxCount is not null )
BEGIN
	IF( @MaxCount < @MaxRow )
	BEGIN
		SET ROWCOUNT @MaxCount
	END
	ELSE
	BEGIN
		SET ROWCOUNT @maxRow
	END
END
ELSE
BEGIN
	SET ROWCOUNT @maxRow
END

-- Create Temporary Table

CREATE TABLE #TempItems 
(
   ID int IDENTITY,
   ArticleID int
)

EXEC(''
INSERT INTO #TempItems (ArticleID) 
SELECT 
	Article.[ArticleID]
FROM
	dbo.GcDesign_Searches_Article Article LEFT OUTER JOIN 
    dbo.GcDesign_Searches_Page Page on Page.ArticleID = Article.ArticleID AND Page.SortOrder = 0 LEFT OUTER JOIN 
	dbo.Users Author ON Article.AuthorID = Author.UserID LEFT OUTER JOIN 
    dbo.Users Updated ON Article.LastUpdateID = Updated.UserID
WHERE '' + 
	@strWhere + ''
ORDER BY 
	'' + @SortBy + '' '' + @SortDirection)

SET ROWCOUNT 0

SELECT 
	Article.[ArticleID],
	Article.[AuthorID],
	Article.[ApproverID],
	Article.[CreatedDate],
	Article.[LastUpdate],
	Article.[Title],
	Article.[Summary],
	Article.[IsApproved],
	Article.[NumberOfViews],
	Article.[StartDate],
	Article.[EndDate],
	Article.[ModuleID],
	Article.[IsFeatured],
	Article.[ImageUrl],
	Article.[LastUpdateID],
	Article.[IsSecure],
	Article.[IsNewWindow],
	Article.[ImageUrl],
	Article.[Url],
	Article.[PageCount],
	Article.[CommentCount],
	Article.[Rating],
	Article.[RatingCount],
	Article.[FileCount],
	Article.[ImageCount],
	Article.[MetaTitle],
	Article.[MetaDescription],
	Article.[MetaKeywords],
	Article.[PageHeadText], 
	Article.[ShortUrl],
	Article.[RssGuid], 
	Author.[Email] as AuthorEmail,
	Author.[UserName] as AuthorUserName,
	Author.[FirstName] as AuthorFirstName,
	Author.[LastName] as AuthorLastName,
	Author.[DisplayName] as AuthorDisplayName,
	Updated.[Email] as LastUpdateEmail,
	Updated.[UserName] as LastUpdateUserName,
	Updated.[FirstName] as LastUpdateFirstName,
	Updated.[LastName] as LastUpdateLastName,
	Updated.[DisplayName] as LastUpdateDisplayName,
	Page.PageText as ''Body'',
	dbo.Ventrian_Searches_SplitTags(Article.[ArticleID]) as ''Tags''   

FROM
	#TempItems t INNER JOIN 
	dbo.GcDesign_Searches_Article Article ON t.ArticleID = Article.ArticleID LEFT OUTER JOIN 
    dbo.GcDesign_Searches_Page Page on Page.ArticleID = Article.ArticleID AND Page.SortOrder = 0 LEFT OUTER JOIN 
	dbo.Users Author ON Article.AuthorID = Author.UserID LEFT OUTER JOIN 
    dbo.Users Updated ON Article.LastUpdateID = Updated.UserID

WHERE
	ID > @startRowIndex
	
ORDER BY
	ID

DROP TABLE #TempItems 

EXEC(''
SELECT 
	COUNT(Article.ArticleID) as ''''TotalRecords'''' 
FROM
	dbo.GcDesign_Searches_Article Article
WHERE '' + 
	@strWhere )' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetArticleListBySearchCriteria]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetArticleListBySearchCriteria]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetArticleListBySearchCriteria]
	@ModuleID [int],
	@CurrentDate [datetime],
	@AgedDate [datetime],
	@CategoryID [varchar](2000),
	@CategoryIDCount [int],
	@CategoryIDExclude [varchar](2000),
	@MaxCount [int],
	@PageNumber [int],
	@PageSize [int],
	@SortBy [varchar](50),
	@SortDirection [varchar](50),
	@IsApproved [bit],
	@IsDraft [bit],
	@KeyWords [nvarchar](255),
	@AuthorID [int],
	@ShowPending [bit],
	@ShowExpired [bit],
	@ShowFeaturedOnly [bit],
	@ShowNotFeaturedOnly [bit],
	@ShowSecuredOnly [bit],
	@ShowNotSecuredOnly [bit],
	@ArticleIDs [varchar](255),
	@TagID [varchar](2000),
	@TagIDCount [int],
	@RssGuid [nvarchar](255),
	@CustomFieldID [int],
	@CustomValue [nvarchar](255),
	@LinkFilter [nvarchar](255)
WITH EXECUTE AS CALLER
AS
-- Form Where Query

DECLARE @strWhere	nvarchar(4000)
SELECT @strWhere = ''Article.ModuleID = '' + convert(nvarchar, @ModuleId)

IF( @CurrentDate is null )
	SELECT @CurrentDate = GetDate()

IF( @ShowPending is null )
BEGIN
	SELECT @strWhere = @strWhere + '' AND (Article.StartDate is null OR (Article.StartDate <= '''''' + CONVERT(char(24), @CurrentDate, 126)  + '''''' AND Article.StartDate <= GetDate()))''
	
	IF( @AgedDate is not null )
		SELECT @strWhere = @strWhere + '' AND Article.StartDate >= '''''' + CONVERT(char(24), @AgedDate, 126)  + ''''''''
END
ELSE
BEGIN
	IF( @AgedDate is not null )
			SELECT @strWhere = @strWhere + '' AND Article.StartDate >= '''''' + CONVERT(char(24), @AgedDate, 126)  + ''''''''
END

IF( @ShowExpired is null )
BEGIN
	SELECT @strWhere = @strWhere + '' AND (Article.EndDate is null OR Article.EndDate >= '''''' + CONVERT(char(24), @CurrentDate, 126)  + '''''')''
END

IF (@CategoryId is not null)
BEGIN
	IF(@CategoryIDCount is not null)
	BEGIN
		SELECT @strWhere = @strWhere + '' AND Article.ArticleID in ( select ArticleID from dbo.GcDesign_Searches_ArticleCategories where dbo.GcDesign_Searches_ArticleCategories.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleCategories.CategoryID in ('' + @CategoryID + '') group by articleID having count(*) > '' + convert(nvarchar, @CategoryIDCount) + '')''
	END
	ELSE
	BEGIN
		IF( CHARINDEX(''-1'', @CategoryID) = 0 )
		BEGIN
			SELECT @strWhere = @strWhere + '' AND Article.ArticleID in ( select ArticleID from dbo.GcDesign_Searches_ArticleCategories where dbo.GcDesign_Searches_ArticleCategories.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleCategories.CategoryID in ('' + @CategoryID + ''))''
		END
		ELSE
		BEGIN
			SELECT @strWhere = @strWhere + '' AND (Article.ArticleID in ( select ArticleID from dbo.GcDesign_Searches_ArticleCategories where dbo.GcDesign_Searches_ArticleCategories.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleCategories.CategoryID in ('' + @CategoryID + '')) OR  Article.ArticleID not in (select ArticleID from dbo.GcDesign_Searches_ArticleCategories))''
		END
	END
END

IF (@CategoryIDExclude is not null)
	SELECT @strWhere = @strWhere + '' AND Article.ArticleID not in ( select ArticleID from dbo.GcDesign_Searches_ArticleCategories where dbo.GcDesign_Searches_ArticleCategories.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleCategories.CategoryID in ('' + @CategoryIDExclude + ''))''

IF (@CategoryIDExclude is not null)
	SELECT @strWhere = @strWhere + '' AND Article.ArticleID not in ( select ArticleID from dbo.GcDesign_Searches_ArticleCategories where dbo.GcDesign_Searches_ArticleCategories.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleCategories.CategoryID in ('' + @CategoryIDExclude + ''))''

IF (@AuthorID is not null)
	SELECT @strWhere = @strWhere + '' AND Article.AuthorID = '' + convert(nvarchar, @AuthorID)

IF (@IsApproved = 1 )
	SELECT @strWhere = @strWhere + '' AND Article.IsApproved = 1''

IF (@IsApproved = 0 )
	SELECT @strWhere = @strWhere + '' AND Article.IsApproved = 0''

IF (@IsDraft = 0)
	SELECT @strWhere = @strWhere + '' AND Article.IsDraft = 0''

IF (@IsDraft = 1 )
	SELECT @strWhere = @strWhere + '' AND Article.IsDraft = 1''

IF (@ShowFeaturedOnly = 1 )
	SELECT @strWhere = @strWhere + '' AND Article.IsFeatured = 1''
	
IF (@ShowNotFeaturedOnly = 1 )
	SELECT @strWhere = @strWhere + '' AND Article.IsFeatured = 0''

IF (@ShowSecuredOnly = 1 )
	SELECT @strWhere = @strWhere + '' AND Article.IsSecure = 1''
	
IF (@ShowNotSecuredOnly = 1 )
	SELECT @strWhere = @strWhere + '' AND Article.IsSecure = 0''

IF (@Keywords is not null)
BEGIN
	IF( LEN(@Keywords) = 1 ) 
	BEGIN
		SELECT @strWhere = @strWhere + '' AND (Article.Title LIKE N'''''' + @Keywords + ''%'''')''
	END
	ELSE
	BEGIN
		SELECT @strWhere = @strWhere + '' AND (Article.Title LIKE N''''%'' + @Keywords + ''%'''' OR Article.Summary LIKE N''''%'' + @Keywords + ''%'''' OR ((select count(*) from dbo.GcDesign_Searches_Page Page where Page.ArticleID = Article.ArticleID and Page.PageText LIKE N''''%'' + @Keywords + ''%'''') > 0) OR ((select count(*) from dbo.GcDesign_Searches_CustomValue cv where cv.ArticleID = Article.ArticleID and cv.CustomValue LIKE N''''%'' + @Keywords + ''%'''') > 0))''
	END
END

IF (@CustomFieldID is not null AND @CustomValue is not null)
	SELECT @strWhere = @strWhere + '' AND Article.ArticleID IN (SELECT ArticleID FROM dbo.GcDesign_Searches_CustomValue cv WHERE cv.customFieldID = '' + convert(nvarchar, @CustomFieldID) + '' AND cv.CustomValue LIKE N''''%'' + @CustomValue + ''%'''')''

IF (@ArticleIDs is not null)
	SELECT @strWhere = @strWhere + '' AND Article.ArticleID in ('' + @ArticleIDs + '')''
	
IF (@SortBy = ''Title'') 
	SELECT @SortBy = ''Article.Title''

IF (@SortBy = ''IsFeatured DESC, Title'') 
	SELECT @SortBy = ''IsFeatured DESC, Article.Title''

IF (@TagID is not null)
	if(@TagIDCount is not null)
		SELECT @strWhere = @strWhere + '' AND Article.ArticleID in ( select ArticleID from dbo.GcDesign_Searches_ArticleTag where dbo.GcDesign_Searches_ArticleTag.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleTag.TagID in ('' + @TagID + '') group by articleID having count(*) > '' + convert(nvarchar, @TagIDCount) + '')''
	else
		SELECT @strWhere = @strWhere + '' AND Article.ArticleID in ( select ArticleID from dbo.GcDesign_Searches_ArticleTag where dbo.GcDesign_Searches_ArticleTag.ArticleID = Article.ArticleID and dbo.GcDesign_Searches_ArticleTag.TagID in ('' + @TagID + ''))''

IF (@RssGuid is not null)
	SELECT @strWhere = @strWhere + '' AND Article.RssGuid = N'''''' + @RssGuid + ''''''''
	
IF (@LinkFilter is not null)
	SELECT @strWhere = @strWhere + '' AND Article.Url = N'''''' + @LinkFilter + ''''''''
	
-- Set Paging Options

IF( @PageNumber is null )
	SET @PageNumber = 1

IF( @PageSize is null )
	SET @PageSize = 100

SET @PageNumber = @PageNumber - 1

DECLARE @startRowIndex int
SET @startRowIndex = (@PageNumber * @PageSize)

DECLARE @maxRow int
SET @maxRow = (@startRowIndex + @PageSize)
IF( @MaxCount is not null )
BEGIN
	IF( @MaxCount < @MaxRow )
	BEGIN
		SET ROWCOUNT @MaxCount
	END
	ELSE
	BEGIN
		SET ROWCOUNT @maxRow
	END
END
ELSE
BEGIN
	SET ROWCOUNT @maxRow
END

-- Create Temporary Table

CREATE TABLE #TempItems 
(
   ID int IDENTITY,
   ArticleID int
)

EXEC(''
INSERT INTO #TempItems (ArticleID) 
SELECT 
	Article.[ArticleID]
FROM
	dbo.GcDesign_Searches_Article Article LEFT OUTER JOIN 
    dbo.GcDesign_Searches_Page Page on Page.ArticleID = Article.ArticleID AND Page.SortOrder = 0 LEFT OUTER JOIN 
	dbo.Users Author ON Article.AuthorID = Author.UserID LEFT OUTER JOIN 
    dbo.Users Updated ON Article.LastUpdateID = Updated.UserID
WHERE '' + 
	@strWhere + ''
ORDER BY 
	'' + @SortBy + '' '' + @SortDirection)

SET ROWCOUNT 0

SELECT 
	Article.[ArticleID],
	Article.[AuthorID],
	Article.[ApproverID],
	Article.[CreatedDate],
	Article.[LastUpdate],
	Article.[Title],
	Article.[Summary],
	Article.[IsApproved],
	Article.[NumberOfViews],
	Article.[StartDate],
	Article.[EndDate],
	Article.[ModuleID],
	Article.[IsFeatured],
	Article.[ImageUrl],
	Article.[LastUpdateID],
	Article.[IsSecure],
	Article.[IsNewWindow],
	Article.[ImageUrl],
	Article.[Url],
	Article.[PageCount],
	Article.[CommentCount],
	Article.[Rating],
	Article.[RatingCount],
	Article.[FileCount],
	Article.[ImageCount],
	Article.[MetaTitle],
	Article.[MetaDescription],
	Article.[MetaKeywords],
	Article.[PageHeadText], 
	Article.[ShortUrl],
	Article.[RssGuid], 
	Author.[Email] as AuthorEmail,
	Author.[UserName] as AuthorUserName,
	Author.[FirstName] as AuthorFirstName,
	Author.[LastName] as AuthorLastName,
	Author.[DisplayName] as AuthorDisplayName,
	Updated.[Email] as LastUpdateEmail,
	Updated.[UserName] as LastUpdateUserName,
	Updated.[FirstName] as LastUpdateFirstName,
	Updated.[LastName] as LastUpdateLastName,
	Updated.[DisplayName] as LastUpdateDisplayName,
	Page.PageText as ''Body'',
	dbo.Ventrian_Searches_SplitTags(Article.[ArticleID]) as ''Tags''   

FROM
	#TempItems t INNER JOIN 
	dbo.GcDesign_Searches_Article Article ON t.ArticleID = Article.ArticleID LEFT OUTER JOIN 
    dbo.GcDesign_Searches_Page Page on Page.ArticleID = Article.ArticleID AND Page.SortOrder = 0 LEFT OUTER JOIN 
	dbo.Users Author ON Article.AuthorID = Author.UserID LEFT OUTER JOIN 
    dbo.Users Updated ON Article.LastUpdateID = Updated.UserID

WHERE
	ID > @startRowIndex
	
ORDER BY
	ID

DROP TABLE #TempItems 

EXEC(''
SELECT 
	COUNT(Article.ArticleID) as ''''TotalRecords'''' 
FROM
	dbo.GcDesign_Searches_Article Article
WHERE '' + 
	@strWhere )' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetArticleCategories]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetArticleCategories]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetArticleCategories]
	@ArticleID [int]
WITH EXECUTE AS CALLER
AS
SELECT      
	Category.CategoryID, 
    Category.[Name], 
    Category.[InheritSecurity]
FROM         
	dbo.GcDesign_Searches_ArticleCategories ArticleCategories, dbo.GcDesign_Searches_Category Category
WHERE
	ArticleCategories.CategoryID = Category.CategoryID
	AND
	ArticleCategories.ArticleID = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetArticle]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetArticle]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetArticle]
	@ArticleID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	Article.[ArticleID],
	Article.[AuthorID],
	Article.[ApproverID],
	Article.[CreatedDate],
	Article.[LastUpdate],
	Article.[Title],
	Article.[Summary],
	Article.[IsApproved],
	Article.[NumberOfViews],
	Article.[IsDraft],
	Article.[StartDate],
	Article.[EndDate],
	Article.[ModuleID],
	Article.[IsFeatured],
	Article.[ImageUrl],
	Article.[LastUpdateID],
	Article.[IsSecure],
	Article.[IsNewWindow],
	Article.[ImageUrl],
	Article.[Url],
	Article.[PageCount],
	Article.[CommentCount],
	Article.[Rating],
	Article.[RatingCount],
	Article.[FileCount],
	Article.[ImageCount],
	Article.[MetaTitle],
	Article.[MetaDescription],
	Article.[MetaKeywords],
	Article.[PageHeadText], 
	Article.[ShortUrl],
	Article.[RssGuid], 
	Author.[Email] as AuthorEmail,
	Author.[UserName] as AuthorUserName,
	Author.[FirstName] as AuthorFirstName,
	Author.[LastName] as AuthorLastName,
	Author.[DisplayName] as AuthorDisplayName,
	Updated.[Email] as LastUpdateEmail,
	Updated.[UserName] as LastUpdateUserName,
	Updated.[FirstName] as LastUpdateFirstName,
	Updated.[LastName] as LastUpdateLastName,
	Updated.[DisplayName] as UpdatedDisplayName,
	Page.PageText as ''Body'',
	dbo.Ventrian_Searches_SplitTags(Article.[ArticleID]) as ''Tags''   
FROM
	dbo.GcDesign_Searches_Article Article LEFT OUTER JOIN 
		dbo.GcDesign_Searches_Page Page on Page.ArticleID = Article.ArticleID AND Page.SortOrder = 0 LEFT OUTER JOIN 
		dbo.Users Author ON Article.AuthorID = Author.UserID LEFT OUTER JOIN
		dbo.Users Updated ON Article.LastUpdateID = Updated.UserID

WHERE	
	Article.[ArticleID] = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetPageList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetPageList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetPageList]
	@ArticleID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	[PageID],
	[ArticleID],
	[Title], 
	[PageText],
	[SortOrder]
FROM
	dbo.GcDesign_Searches_Page

WHERE
	[ArticleID] = @ArticleID

ORDER BY
	[SortOrder] ASC' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetPage]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetPage]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetPage]
	@PageID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	[PageID],
	[ArticleID],
	[Title], 
	[PageText],
	[SortOrder]
FROM
	dbo.GcDesign_Searches_Page
WHERE
	[PageID] = @PageID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCommentList]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCommentList]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetCommentList]
	@ModuleID [int],
	@ArticleID [int],
	@IsApproved [bit],
	@SortDirection [int],
	@MaxCount [int]
WITH EXECUTE AS CALLER
AS
IF( @MaxCount is not null )
BEGIN
	SET ROWCOUNT @MaxCount
END

SELECT
	Comment.[CommentID],
	Comment.[ArticleID],
	Comment.[UserID], 
	Comment.[CreatedDate],
	Comment.[Comment],
	Comment.[RemoteAddress],
	Comment.[Type],
	Comment.[TrackbackUrl],
	Comment.[TrackbackTitle],
	Comment.[TrackbackBlogName],
	Comment.[TrackbackExcerpt], 
	Comment.[AnonymousName], 
	Comment.[AnonymousEmail], 
	Comment.[AnonymousURL],
	Comment.[NotifyMe],  
	Comment.[IsApproved],  
	Comment.[ApprovedBy],  
	Author.[Email] as AuthorEmail,
	Author.[UserName] as AuthorUserName,
	Author.[FirstName] as AuthorFirstName,
	Author.[LastName] as AuthorLastName,
	Author.[DisplayName] as AuthorDisplayName
FROM
	dbo.GcDesign_Searches_Comment Comment INNER JOIN
		dbo.GcDesign_Searches_Article Article on Comment.ArticleID = Article.ArticleID LEFT OUTER JOIN
		dbo.Users Author ON Comment.UserID = Author.UserID
WHERE
	Article.ModuleID = @ModuleID
	and
	(@ArticleID is null OR Comment.[ArticleID] = @ArticleID)
	and
	Comment.IsApproved = @IsApproved
ORDER BY
	CASE WHEN @SortDirection = 0 THEN Comment.[CreatedDate] END ASC, 
	CASE WHEN @SortDirection = 1 THEN Comment.[CreatedDate] END DESC' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetComment]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetComment]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetComment]
	@CommentID [int]
WITH EXECUTE AS CALLER
AS
SELECT
	Comment.[CommentID],
	Comment.[ArticleID],
	Comment.[UserID], 
	Comment.[CreatedDate],
	Comment.[Comment],
	Comment.[RemoteAddress],
	Comment.[Type],
	Comment.[TrackbackUrl],
	Comment.[TrackbackTitle],
	Comment.[TrackbackBlogName],
	Comment.[TrackbackExcerpt], 
	Comment.[AnonymousName], 
	Comment.[AnonymousEmail], 
	Comment.[AnonymousURL], 
	Comment.[NotifyMe], 
	Comment.[IsApproved],  
	Comment.[ApprovedBy],  
	Author.[Email] as AuthorEmail,
	Author.[UserName] as AuthorUserName,
	Author.[FirstName] as AuthorFirstName,
	Author.[LastName] as AuthorLastName,
	Author.[DisplayName] as AuthorDisplayName
FROM
	dbo.GcDesign_Searches_Comment Comment LEFT OUTER JOIN
		dbo.Users Author ON Comment.UserID = Author.UserID
WHERE
	[CommentID] = @CommentID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_GetCategoryListAll]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_GetCategoryListAll]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_GetCategoryListAll]
	@ModuleID [int],
	@AuthorID [int],
	@ShowPending [bit],
	@SortType [int]
WITH EXECUTE AS CALLER
AS
;WITH CategoryHierarchy AS
(
	SELECT
		CategoryID,
		ParentID,
        CONVERT(nvarchar(max), Name) AS Path,
		1 as level,
		(SortOrder+1) * (CONVERT(bigint, ''1'' + REPLICATE(''0'', 10))) AS ''SortOrderCount''
	FROM
		dbo.GcDesign_Searches_Category
	WHERE
		ParentID = -1 
		AND
		ModuleID = @ModuleID

	UNION ALL

	SELECT
		TH.CategoryID,
		TH.ParentID,
        CONVERT(nvarchar(max), CategoryHierarchy.Path + '' \ '' + TH.Name) AS Path,
		level = level + 1,
		CategoryHierarchy.SortOrderCount + (CONVERT(bigint, CONVERT(varchar, (TH.SortOrder+1)) + REPLICATE(''0'', 10-(level*2)))) AS ''SortOrderCount''
	FROM
		dbo.GcDesign_Searches_Category TH INNER JOIN 
			CategoryHierarchy ON CategoryHierarchy.CategoryID = TH.ParentID
)

SELECT 
	SortOrderCount, 
	c.[CategoryID],
	c.[ParentID],
	c.[ModuleID],
	c.[Name],
	REPLICATE(''.'',(level-1)*2) + c.[Name] as ''NameIndented'',
	c.[Image],
	c.[Description],
	c.[SortOrder],
	c.[InheritSecurity],
	c.[CategorySecurityType], 
	c.[MetaTitle],
	c.[MetaDescription],
	c.[MetaKeywords], 
	ch.[level],
	(SELECT COUNT(*) FROM dbo.GcDesign_Searches_ArticleCategories ac INNER JOIN dbo.GcDesign_Searches_Article a ON ac.ArticleID = a.ArticleID WHERE ac.CategoryID = c.CategoryID AND a.IsDraft = 0 AND a.IsApproved = 1 AND (@authorId IS NULL OR a.AuthorID = @authorID) AND (@ShowPending IS NOT NULL OR (a.StartDate IS NULL OR a.StartDate < GetDate()))) as ''NumberofArticles''
FROM 
	CategoryHierarchy ch INNER JOIN
		dbo.GcDesign_Searches_Category c ON ch.CategoryID = c.CategoryID
ORDER BY 
	CASE WHEN @SortType = 0 THEN CAST(ch.SortOrderCount AS VARCHAR) ELSE ch.Path END' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddArticleCategory]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddArticleCategory]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_AddArticleCategory]
	@ArticleID [int],
	@CategoryID [int]
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_ArticleCategories( ArticleID, CategoryID )
VALUES (@ArticleID, @CategoryID)' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddArticle]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddArticle]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_AddArticle]
	@AuthorID [int],
	@ApproverID [int],
	@CreatedDate [datetime],
	@LastUpdate [datetime],
	@Title [nvarchar](255),
	@Summary [ntext],
	@IsApproved [bit],
	@NumberOfViews [int],
	@IsDraft [bit],
	@StartDate [datetime],
	@EndDate [datetime],
	@ModuleID [int],
	@ImageUrl [nvarchar](255),
	@IsFeatured [bit],
	@LastUpdateID [int],
	@Url [nvarchar](255),
	@IsSecure [bit],
	@IsNewWindow [bit],
	@MetaTitle [nvarchar](200),
	@MetaDescription [nvarchar](500),
	@MetaKeywords [nvarchar](500),
	@PageHeadText [nvarchar](500),
	@ShortUrl [nvarchar](50),
	@RssGuid [nvarchar](255)
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_Article (
	[AuthorID],
	[ApproverID],
	[CreatedDate],
	[LastUpdate],
	[Title],
	[Summary],
	[IsApproved],
	[NumberOfViews],
	[IsDraft],
	[StartDate],
	[EndDate],
	[ModuleID],
	[ImageUrl],
	[IsFeatured], 
	[LastUpdateID], 
	[Url],
	[IsSecure],
	[IsNewWindow],
	[MetaTitle],
	[MetaDescription],
	[MetaKeywords],
	[PageHeadText],
	[ShortUrl],
	[RssGuid]  
) VALUES (
	@AuthorID,
	@ApproverID,
	@CreatedDate,
	@LastUpdate,
	@Title,
	@Summary,
	@IsApproved,
	@NumberOfViews,
	@IsDraft,
	@StartDate,
	@EndDate,
	@ModuleID,
	@ImageUrl,
	@IsFeatured,
	@LastUpdateID,
	@Url,
	@IsSecure,
	@IsNewWindow,
	@MetaTitle,
	@MetaDescription,
	@MetaKeywords,
	@PageHeadText,
	@ShortUrl,
	@RssGuid      
)

select SCOPE_IDENTITY()

UPDATE dbo.GcDesign_Searches_Article
SET [PageCount] = (select count(*) from dbo.GcDesign_Searches_Page Page where Page.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE ArticleID = SCOPE_IDENTITY()

UPDATE dbo.GcDesign_Searches_Article
SET [CommentCount] = (select count(*) from dbo.GcDesign_Searches_Comment Comment where Comment.ArticleID = dbo.GcDesign_Searches_Article.ArticleID and Comment.IsApproved = 1)
WHERE ArticleID = SCOPE_IDENTITY()

UPDATE dbo.GcDesign_Searches_Article
SET [Rating] = (select AVG(rating) from dbo.GcDesign_Searches_Rating Rating where Rating.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = SCOPE_IDENTITY() 

UPDATE dbo.GcDesign_Searches_Article
SET [RatingCount] = (select COUNT(*) from dbo.GcDesign_Searches_Rating Rating where Rating.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = SCOPE_IDENTITY() 

UPDATE dbo.GcDesign_Searches_Article
SET [ImageCount] = (select COUNT(*) from dbo.GcDesign_Searches_Image i where i.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = SCOPE_IDENTITY() 

UPDATE dbo.GcDesign_Searches_Article
SET [FileCount] = (select COUNT(*) from dbo.GcDesign_Searches_File f where f.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE [ArticleID] = SCOPE_IDENTITY()' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeletePage]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeletePage]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_DeletePage]
	@PageID [int]
WITH EXECUTE AS CALLER
AS
DECLARE @ArticleID int
SELECT @ArticleID = ArticleID FROM dbo.GcDesign_Searches_Page WHERE [PageID] = @PageID

DELETE FROM dbo.GcDesign_Searches_Page
WHERE
	[PageID] = @PageID

UPDATE dbo.GcDesign_Searches_Article
SET [PageCount] = (select count(*) from dbo.GcDesign_Searches_Page Page where Page.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE ArticleID = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteComment]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteComment]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_DeleteComment]
	@CommentID [int]
WITH EXECUTE AS CALLER
AS
DECLARE @ArticleID int
SELECT @ArticleID = ArticleID FROM dbo.GcDesign_Searches_Comment WHERE [CommentID] = @CommentID

DELETE FROM dbo.GcDesign_Searches_Comment
WHERE [CommentID] = @CommentID

UPDATE dbo.GcDesign_Searches_Article
SET [CommentCount] = (select count(*) from dbo.GcDesign_Searches_Comment Comment where Comment.ArticleID = dbo.GcDesign_Searches_Article.ArticleID and Comment.IsApproved = 1)
WHERE ArticleID = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteCategory]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteCategory]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_DeleteCategory]
	@CategoryID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM dbo.GcDesign_Searches_ArticleCategories
WHERE
	[CategoryID] = @CategoryID

DELETE FROM dbo.GcDesign_Searches_Category
WHERE
	[CategoryID] = @CategoryID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteArticleCategories]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteArticleCategories]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_DeleteArticleCategories]
	@ArticleID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM dbo.GcDesign_Searches_ArticleCategories
WHERE
	[ArticleID] = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_DeleteArticle]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_DeleteArticle]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_DeleteArticle]
	@ArticleID [int]
WITH EXECUTE AS CALLER
AS
DELETE FROM 
	dbo.GcDesign_Searches_CustomValue
WHERE
	[ArticleID] = @ArticleID

DELETE FROM 
	dbo.GcDesign_Searches_Image
WHERE
	[ArticleID] = @ArticleID

DELETE FROM 
	dbo.GcDesign_Searches_File
WHERE
	[ArticleID] = @ArticleID

DELETE FROM dbo.GcDesign_Searches_ArticleCategories
WHERE
	[ArticleID] = @ArticleID

DELETE FROM dbo.GcDesign_Searches_Article
WHERE
	[ArticleID] = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddComment]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddComment]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_AddComment]
	@ArticleID [int],
	@CreatedDate [datetime],
	@UserID [int],
	@Comment [ntext],
	@RemoteAddress [nvarchar](50),
	@Type [int],
	@TrackbackUrl [nvarchar](255),
	@TrackbackTitle [nvarchar](255),
	@TrackbackBlogName [nvarchar](255),
	@TrackbackExcerpt [ntext],
	@AnonymousName [nvarchar](255),
	@AnonymousEmail [nvarchar](255),
	@AnonymousURL [nvarchar](255),
	@NotifyMe [bit],
	@IsApproved [bit],
	@ApprovedBy [int]
WITH EXECUTE AS CALLER
AS
INSERT INTO dbo.GcDesign_Searches_Comment (
	[ArticleID],
	[CreatedDate], 
	[UserID], 
	[Comment],
	[RemoteAddress],
	[Type],
	[TrackbackUrl],
	[TrackbackTitle],
	[TrackbackBlogName],
	[TrackbackExcerpt],
	[AnonymousName], 
	[AnonymousEmail],
	[AnonymousURL],
	[NotifyMe],
	[IsApproved],
	[ApprovedBy]
) VALUES (
	@ArticleID,
	@CreatedDate, 
	@UserID, 
	@Comment,
	@RemoteAddress,
	@Type,
	@TrackbackUrl,
	@TrackbackTitle,
	@TrackbackBlogName,
	@TrackbackExcerpt,
	@AnonymousName,
	@AnonymousEmail,
	@AnonymousURL,
	@NotifyMe,
	@IsApproved,
	@ApprovedBy  
)

select SCOPE_IDENTITY()

UPDATE dbo.GcDesign_Searches_Article
SET [CommentCount] = (select count(*) from dbo.GcDesign_Searches_Comment Comment where Comment.ArticleID = dbo.GcDesign_Searches_Article.ArticleID and Comment.IsApproved = 1)
WHERE ArticleID = @ArticleID' 
    END
GO
/****** Object:  StoredProcedure [dbo].[GcDesign_Searches_AddPage]    Script Date: 04/19/2015 21:16:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS ( SELECT  *
                FROM    sys.objects
                WHERE   object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_AddPage]')
                        AND type IN ( N'P', N'PC' ) )
    BEGIN
        EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GcDesign_Searches_AddPage]
	@ArticleID [int],
	@Title [nvarchar](255),
	@PageText [nvarchar](max),
	@SortOrder [int]
WITH EXECUTE AS CALLER
AS
declare @count int

select @count = (select count(*) from dbo.GcDesign_Searches_Page where ArticleID = @ArticleID)

INSERT INTO dbo.GcDesign_Searches_Page (
	[ArticleID],
	[Title],
	[PageText],
	[SortOrder]
) VALUES (
	@ArticleID,
	@Title,
	@PageText,
	@count
)

select SCOPE_IDENTITY()

UPDATE dbo.GcDesign_Searches_Article
SET [PageCount] = (select count(*) from dbo.GcDesign_Searches_Page Page where Page.ArticleID = dbo.GcDesign_Searches_Article.ArticleID)
WHERE ArticleID = @ArticleID' 
    END
GO
/****** Object:  Default [DF__GcDesign___IsSec__689361F1]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.default_constraints
                WHERE   object_id = OBJECT_ID(N'[dbo].[DF__GcDesign___IsSec__689361F1]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Article]') )
    BEGIN
        IF NOT EXISTS ( SELECT  *
                        FROM    dbo.sysobjects
                        WHERE   id = OBJECT_ID(N'[DF__GcDesign___IsSec__689361F1]')
                                AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Article] ADD  CONSTRAINT [DF__GcDesign___IsSec__689361F1]  DEFAULT ((0)) FOR [IsSecure]
            END


    END
GO
/****** Object:  Default [DF_GcDesign_Searches_Article_IsNewWindow]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.default_constraints
                WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Article_IsNewWindow]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Article]') )
    BEGIN
        IF NOT EXISTS ( SELECT  *
                        FROM    dbo.sysobjects
                        WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Article_IsNewWindow]')
                                AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Article] ADD  CONSTRAINT [DF_GcDesign_Searches_Article_IsNewWindow]  DEFAULT ((0)) FOR [IsNewWindow]
            END


    END
GO
/****** Object:  Default [DF_GcDesign_Searches_Category_InheritSecurity]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.default_constraints
                WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Category_InheritSecurity]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Category]') )
    BEGIN
        IF NOT EXISTS ( SELECT  *
                        FROM    dbo.sysobjects
                        WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Category_InheritSecurity]')
                                AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Category] ADD  CONSTRAINT [DF_GcDesign_Searches_Category_InheritSecurity]  DEFAULT ((1)) FOR [InheritSecurity]
            END


    END
GO
/****** Object:  Default [DF_GcDesign_Searches_Category_CategorySecurityType]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.default_constraints
                WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Category_CategorySecurityType]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Category]') )
    BEGIN
        IF NOT EXISTS ( SELECT  *
                        FROM    dbo.sysobjects
                        WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Category_CategorySecurityType]')
                                AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Category] ADD  CONSTRAINT [DF_GcDesign_Searches_Category_CategorySecurityType]  DEFAULT ((0)) FOR [CategorySecurityType]
            END


    END
GO
/****** Object:  Default [DF_GcDesign_Searches_Comment_CreatedDate]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.default_constraints
                WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Comment_CreatedDate]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]') )
    BEGIN
        IF NOT EXISTS ( SELECT  *
                        FROM    dbo.sysobjects
                        WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Comment_CreatedDate]')
                                AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Comment] ADD  CONSTRAINT [DF_GcDesign_Searches_Comment_CreatedDate]  DEFAULT (GETDATE()) FOR [CreatedDate]
            END


    END
GO
/****** Object:  Default [DF__GcDesign_S__Type__548C6944]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.default_constraints
                WHERE   object_id = OBJECT_ID(N'[dbo].[DF__GcDesign_S__Type__548C6944]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]') )
    BEGIN
        IF NOT EXISTS ( SELECT  *
                        FROM    dbo.sysobjects
                        WHERE   id = OBJECT_ID(N'[DF__GcDesign_S__Type__548C6944]')
                                AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Comment] ADD  CONSTRAINT [DF__GcDesign_S__Type__548C6944]  DEFAULT ((0)) FOR [Type]
            END


    END
GO
/****** Object:  Default [DF_GcDesign_Searches_Comment_NotifyMe]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.default_constraints
                WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Comment_NotifyMe]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]') )
    BEGIN
        IF NOT EXISTS ( SELECT  *
                        FROM    dbo.sysobjects
                        WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Comment_NotifyMe]')
                                AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Comment] ADD  CONSTRAINT [DF_GcDesign_Searches_Comment_NotifyMe]  DEFAULT ((0)) FOR [NotifyMe]
            END


    END
GO
/****** Object:  Default [DF_GcDesign_Searches_Comment_isApproved]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.default_constraints
                WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Comment_isApproved]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]') )
    BEGIN
        IF NOT EXISTS ( SELECT  *
                        FROM    dbo.sysobjects
                        WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Comment_isApproved]')
                                AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Comment] ADD  CONSTRAINT [DF_GcDesign_Searches_Comment_isApproved]  DEFAULT ((1)) FOR [isApproved]
            END


    END
GO
/****** Object:  Default [DF_GcDesign_Searches_Feed_DateMode]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.default_constraints
                WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Feed_DateMode]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Feed]') )
    BEGIN
        IF NOT EXISTS ( SELECT  *
                        FROM    dbo.sysobjects
                        WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Feed_DateMode]')
                                AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Feed] ADD  CONSTRAINT [DF_GcDesign_Searches_Feed_DateMode]  DEFAULT ((0)) FOR [DateMode]
            END


    END
GO
/****** Object:  Default [DF_GcDesign_Searches_Image_SortOrder]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.default_constraints
                WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Image_SortOrder]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Image]') )
    BEGIN
        IF NOT EXISTS ( SELECT  *
                        FROM    dbo.sysobjects
                        WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Image_SortOrder]')
                                AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Image] ADD  CONSTRAINT [DF_GcDesign_Searches_Image_SortOrder]  DEFAULT ((0)) FOR [SortOrder]
            END


    END
GO
/****** Object:  Default [DF_GcDesign_Searches_Page_SortOrder]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.default_constraints
                WHERE   object_id = OBJECT_ID(N'[dbo].[DF_GcDesign_Searches_Page_SortOrder]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Page]') )
    BEGIN
        IF NOT EXISTS ( SELECT  *
                        FROM    dbo.sysobjects
                        WHERE   id = OBJECT_ID(N'[DF_GcDesign_Searches_Page_SortOrder]')
                                AND type = 'D' )
            BEGIN
                ALTER TABLE [dbo].[GcDesign_Searches_Page] ADD  CONSTRAINT [DF_GcDesign_Searches_Page_SortOrder]  DEFAULT ((0)) FOR [SortOrder]
            END


    END
GO
/****** Object:  ForeignKey [FK_GcDesign_Searches_Article_Modules]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.foreign_keys
                WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_Article_Modules]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Article]') )
    ALTER TABLE [dbo].[GcDesign_Searches_Article]  WITH NOCHECK ADD  CONSTRAINT [FK_GcDesign_Searches_Article_Modules] FOREIGN KEY([ModuleID])
    REFERENCES [dbo].[Modules] ([ModuleID])
    ON DELETE CASCADE
    NOT FOR REPLICATION
GO
IF EXISTS ( SELECT  *
            FROM    sys.foreign_keys
            WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_Article_Modules]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Article]') )
    ALTER TABLE [dbo].[GcDesign_Searches_Article] CHECK CONSTRAINT [FK_GcDesign_Searches_Article_Modules]
GO
/****** Object:  ForeignKey [FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Article]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.foreign_keys
                WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Article]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleCategories]') )
    ALTER TABLE [dbo].[GcDesign_Searches_ArticleCategories]  WITH NOCHECK ADD  CONSTRAINT [FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Article] FOREIGN KEY([ArticleID])
    REFERENCES [dbo].[GcDesign_Searches_Article] ([ArticleID])
    ON DELETE CASCADE
    NOT FOR REPLICATION
GO
IF EXISTS ( SELECT  *
            FROM    sys.foreign_keys
            WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Article]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleCategories]') )
    ALTER TABLE [dbo].[GcDesign_Searches_ArticleCategories] CHECK CONSTRAINT [FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Article]
GO
/****** Object:  ForeignKey [FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Category]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.foreign_keys
                WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Category]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleCategories]') )
    ALTER TABLE [dbo].[GcDesign_Searches_ArticleCategories]  WITH NOCHECK ADD  CONSTRAINT [FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Category] FOREIGN KEY([CategoryID])
    REFERENCES [dbo].[GcDesign_Searches_Category] ([CategoryID])
    NOT FOR REPLICATION
GO
IF EXISTS ( SELECT  *
            FROM    sys.foreign_keys
            WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Category]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_ArticleCategories]') )
    ALTER TABLE [dbo].[GcDesign_Searches_ArticleCategories] CHECK CONSTRAINT [FK_GcDesign_Searches_ArticleCategories_GcDesign_Searches_Category]
GO
/****** Object:  ForeignKey [FK_GcDesign_Searches_Category_Modules]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.foreign_keys
                WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_Category_Modules]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Category]') )
    ALTER TABLE [dbo].[GcDesign_Searches_Category]  WITH NOCHECK ADD  CONSTRAINT [FK_GcDesign_Searches_Category_Modules] FOREIGN KEY([ModuleID])
    REFERENCES [dbo].[Modules] ([ModuleID])
    ON DELETE CASCADE
    NOT FOR REPLICATION
GO
IF EXISTS ( SELECT  *
            FROM    sys.foreign_keys
            WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_Category_Modules]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Category]') )
    ALTER TABLE [dbo].[GcDesign_Searches_Category] CHECK CONSTRAINT [FK_GcDesign_Searches_Category_Modules]
GO
/****** Object:  ForeignKey [FK_GcDesign_Searches_Comment_GcDesign_Searches_Article]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.foreign_keys
                WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_Comment_GcDesign_Searches_Article]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]') )
    ALTER TABLE [dbo].[GcDesign_Searches_Comment]  WITH NOCHECK ADD  CONSTRAINT [FK_GcDesign_Searches_Comment_GcDesign_Searches_Article] FOREIGN KEY([ArticleID])
    REFERENCES [dbo].[GcDesign_Searches_Article] ([ArticleID])
    ON DELETE CASCADE
    NOT FOR REPLICATION
GO
IF EXISTS ( SELECT  *
            FROM    sys.foreign_keys
            WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_Comment_GcDesign_Searches_Article]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Comment]') )
    ALTER TABLE [dbo].[GcDesign_Searches_Comment] CHECK CONSTRAINT [FK_GcDesign_Searches_Comment_GcDesign_Searches_Article]
GO
/****** Object:  ForeignKey [FK_GcDesign_Searches_Page_GcDesign_Searches_Article]    Script Date: 04/19/2015 21:16:02 ******/
IF NOT EXISTS ( SELECT  *
                FROM    sys.foreign_keys
                WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_Page_GcDesign_Searches_Article]')
                        AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Page]') )
    ALTER TABLE [dbo].[GcDesign_Searches_Page]  WITH NOCHECK ADD  CONSTRAINT [FK_GcDesign_Searches_Page_GcDesign_Searches_Article] FOREIGN KEY([ArticleID])
    REFERENCES [dbo].[GcDesign_Searches_Article] ([ArticleID])
    ON DELETE CASCADE
GO
IF EXISTS ( SELECT  *
            FROM    sys.foreign_keys
            WHERE   object_id = OBJECT_ID(N'[dbo].[FK_GcDesign_Searches_Page_GcDesign_Searches_Article]')
                    AND parent_object_id = OBJECT_ID(N'[dbo].[GcDesign_Searches_Page]') )
    ALTER TABLE [dbo].[GcDesign_Searches_Page] CHECK CONSTRAINT [FK_GcDesign_Searches_Page_GcDesign_Searches_Article]
GO
